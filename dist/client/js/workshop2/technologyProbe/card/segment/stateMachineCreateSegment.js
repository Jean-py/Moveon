"use strict";

//Graphical object
var video = document.getElementById("videoEAT");
var video_js = document.getElementById("videoEAT");

var wrapperCommandAndRange = document.getElementById("wrapperCommandAndRangeid");
var knobMin = document.getElementById("range-slider_handle-min");
var rangeSliderTrack = document.getElementById("rangeSliderTrack");
var knobMax = document.getElementById("range-slider_handle-max");
var wrapperRangerSlider = document.getElementById("range-slider-wrapper");

//Option for the longpress and the speed of the video
var speedrate = 1;
var longPressDelay = "500";

var WIDTH_KNOB = 30;

//State for the creation of segment by Drag and drop
var StateDrag = {
  IDLE: 0,
  DOWN: 1,
  DRAG: 2,
  LONGPRESS: 3
};
var state = StateDrag.IDLE;

//Graphical object of feedback
var segmentFeedback = {
  width: "",
  startPostion: "",
  endPosition: "",
  startDurationVideo: "",
  endDurationVideo: "",
  displayed: false,
  divGraphicalObject: document.getElementById("segmentMinMax")
};

if (!navigator.userAgent.match(/Android|BlackBerry|iPhone|iPad|iPod|Opera Mini|IEMobile/i)) {

  if (knobMin != null) {
    //Mouse
    knobMin.addEventListener("mouseup", function (e) {
      knobMinUpCallback(e);
    }, {
      passive: true
    });
    knobMin.addEventListener("mousedown", function (e) {
      knobMinClick(e);
    }, {
      passive: true
    });
    knobMin.addEventListener("mousemove", function (e) {
      knobMinMove(e);
    }, {
      passive: true
    });

    /*-----MOUSE LONG PRESS-------*/
    knobMin.setAttribute("data-long-press-delay", longPressDelay);
    knobMin.addEventListener('long-press', function (e) {
      // console.log('knobMin.addEventListener(longpress');
      pause();
      longpressCreateSegmentCallback(e);
    });
  }
  if (rangeSliderTrack != null) {

    rangeSliderTrack.addEventListener("mousedown", function (e) {
      ranglerSliderTrackClick(e);
    }, {
      passive: true
    });
    rangeSliderTrack.addEventListener("mouseUp", function (e) {
      rangeSliderTrackEndCallback(e);
    }, {
      passive: true
    });
    rangeSliderTrack.addEventListener("mousemove", function (e) {
      knobMinMove(e);
    }, {
      passive: true
    });

    rangeSliderTrack.addEventListener("long-press", function (e) {
      // console.log('rangeSliderTrack.addEventListener(longpress');
      pause();
      longpressCreateSegmentCallback(e);
    }, false);
  }
  if (wrapperRangerSlider != null) {

    wrapperRangerSlider.addEventListener("mousemove", function (e) {
      knobMinMove(e);
    }, true);

    wrapperRangerSlider.addEventListener("mouseup", function (e) {
      rangeSliderTrackEndCallback(e);
    }, true);
  }
} else {
  if (knobMin != null) {

    //Touch
    knobMin.addEventListener("touchstart", function (e) {
      knobMinClick(e);
    }, {
      passive: true
    });
    knobMin.addEventListener("touchmove", function (e) {
      knobMinMove(e);
    }, {
      passive: true
    });
    knobMin.addEventListener("touchend", function (e) {
      knobMinUpCallback(e);
    }, {
      passive: true
    });

    /*-----MOUSE LONG PRESS-------*/
    knobMin.setAttribute("data-long-press-delay", longPressDelay);
    knobMin.addEventListener('long-press', function (e) {
      // console.log('knobMin.addEventListener(longpress');
      pause();
      longpressCreateSegmentCallback(e);
    });
  }
  if (rangeSliderTrack != null) {

    rangeSliderTrack.addEventListener("touchstart", function (e) {
      ranglerSliderTrackClick(e);
    }, {
      passive: true
    });
    rangeSliderTrack.addEventListener("touchend", function (e) {
      rangeSliderTrackEndCallback(e);
    }, {
      passive: true
    });

    rangeSliderTrack.addEventListener("long-press", function (e) {
      // console.log('rangeSliderTrack.addEventListener(longpress');
      pause();
      longpressCreateSegmentCallback(e);
    }, false);
  }
  if (video != null) {

    video.addEventListener("touchmove", function (e) {
      videoTouchMoveCallback(e);
    }, {
      passive: true
    });
  }
  if (video_js != null) {

    video_js.addEventListener("touchmove", function (e) {
      videoTouchMoveCallback(e);
    }, {
      passive: true
    });
  }
}

/*window.addEventListener("mouseup", function(e){
  rangeSliderTrackEndCallback(e);
}, false);
window.addEventListener("mousemove", function(e){
  knobMinMove(e);
},true );*/

/*Callback function*/
var longpressCreateSegmentCallback = function longpressCreateSegmentCallback(e) {
  e.preventDefault();
  switch (state) {
    case StateDrag.DOWN:
      {

        state = StateDrag.LONGPRESS;
        //pause();
        startCreateSegment(e, video.currentTime);
        break;
      }

  }
  //event.preventDefault();
};

var videoTouchMoveCallback = function videoTouchMoveCallback(e) {
  switch (state) {
    case StateDrag.IDLE:
      {
        state = StateDrag.DRAG;
        break;
      }
  }
};

var ranglerSliderTrackClick = function ranglerSliderTrackClick(e) {
  //  console.log("ranglerSliderTrackClick state : " + state);
  // pause();
  switch (state) {
    case StateDrag.IDLE:
      {
        state = StateDrag.DOWN;
        clearAllTimer();
        updateKnobAndVideoWrapper(e);
        feedbackOnSliderVideo(false);
        break;
      }
  }
  //console.log("function - ranglerSliderTrackClick appel play l147 statemachine ");
  play();
};

var knobMinUpCallback = function knobMinUpCallback(e) {
  //console.log("***knobMinUpCallback *** "+ state);
  switch (state) {
    case StateDrag.IDLE:
      {
        state = StateDrag.IDLE;
        //console.log("function - knobMinUpCallback appel play ");
        //play();
        break;
      }
    case StateDrag.LONGPRESS:
      {
        state = StateDrag.IDLE;
        updateKnobAndVideoWrapper(e);
        stopCreateSegment(e, video.currentTime);
        //console.log("function - knobMinUpCallback appel pause l164 statemachine ");
        play();
        break;
      }
    case StateDrag.DRAG:
      {
        state = StateDrag.IDLE;
        updateKnobAndVideoWrapper(e);
        //console.log("function - knobMinUpCallback appel pause l165 statemachine ");
        pause();
        break;
      }
    case StateDrag.DOWN:
      {
        state = StateDrag.IDLE;
        updateKnobAndVideoWrapper(e);
        //console.log("function - knobMinUpCallback appel pause l172 statemachine ");
        pause();
        break;
      }
  }

  //event.preventDefault();
};

//Create Segment
function startCreateSegment(e, startSegment) {
  if (parseInt(knobMin.style.left, 10) < 0) {
    knobMax.style.left = WIDTH_KNOB / 2 + "px";
  } else {
    knobMax.style.left = knobMin.style.left;
  }
  //else if(parseInt(knobMin.style.left,10) > WIDTH_RANGE_SLIDER_TRACK - WIDTH_KNOB +1) {
  //
  //     }

  knobMax.style.position = "absolute";
  //state  StateDrag.LONGPRESS;
  knobMin.style.background = '#213F8D';
  knobMax.style.visibility = "visible";
  updateSegmentFeedback();
}

function stopCreateSegment(e, stopSegment) {
  var timerLifeSegment = window.setTimeout(function () {
    knobMax.style.visibility = "hidden";
    segmentFeedback.divGraphicalObject.style.visibility = "hidden";
    knobMin.style.background = '#ffffff';
    //createCard();
    window.clearTimeout(timerLifeSegment);
    //console.log("AAA : " + parseInt(knobMax.style.left,10));


    var startP = parseInt(knobMax.style.left, 10) + WIDTH_MID_KNOB_MIN / 2;
    var endP = parseInt(knobMin.style.left, 10) + WIDTH_KNOB;

    // cardManager.execute(new CreateNewCardCommand(startP, endP));
    if (startP < 0) {
      startP = 0;
    }

    Player.createNewCard(startP, endP);

    play();
  }, 700);
}

//Update the feedback of the creation of a segment after a long press
function updateSegmentFeedback() {

  if (parseInt(knobMin.style.left, 10) > parseInt(knobMax.style.left, 10)) {
    segmentFeedback.divGraphicalObject.style.marginLeft = knobMax.style.left;
    segmentFeedback.divGraphicalObject.style.width = Math.abs(parseInt(knobMin.style.left, 10) - parseInt(knobMax.style.left, 10)) + WIDTH_KNOB + "px";
  } else {
    segmentFeedback.divGraphicalObject.style.marginLeft = knobMin.style.left;
    segmentFeedback.divGraphicalObject.style.width = Math.abs(parseInt(knobMin.style.left, 10) - parseInt(knobMax.style.left, 10)) + "px";
  }
  segmentFeedback.divGraphicalObject.style.visibility = "visible";

  if (parseInt(segmentFeedback.divGraphicalObject.style.marginLeft, 10) < 0) {
    //the case if the knob is in the extremun of the loader.
    segmentFeedback.divGraphicalObject.style.marginLeft = " 0 px";
  }
}

/*

//start position on the slider and end position on the slider
function videoToSlider(startDurationVideo, endDurationVideo) {
  var startP = Math.round(((startDurationVideo * NUMBER_OF_TICK) / video.duration) - rangeSliderTrack.offsetLeft);
  var endP = Math.round(((endDurationVideo * NUMBER_OF_TICK) / video.duration) - rangeSliderTrack.offsetLeft);
  return {
    startPosition: startP,
    endPosition: endP
  };
}
*/

var knobMinMove = function knobMinMove(e) {
  switch (state) {
    case StateDrag.DOWN:
      {
        state = StateDrag.DRAG;
        //console.log(" draging etat down");
        updateKnobAndVideoWrapper(e);
        break;
      }
    case StateDrag.DRAG:
      {
        state = StateDrag.DRAG;
        updateKnobAndVideoWrapper(e);
        //console.log(" draging etat drag");
        break;
      }
    case StateDrag.LONGPRESS:
      {
        state = StateDrag.LONGPRESS;
        //console.log("state longpress with mouse move");
        updateKnobAndVideoWrapper(e);
        updateSegmentFeedback();
        break;
      }
  }
};

var knobMinClick = function knobMinClick(e) {
  //console.log("function - knobMinClick" );
  pause();
  //Update video position
  switch (state) {
    case StateDrag.IDLE:
      {
        state = StateDrag.DOWN;
        clearAllTimer();
        break;
      }
  }
  //e.preventDefault();
};

var rangeSliderTrackEndCallback = function rangeSliderTrackEndCallback(e) {
  //console.log("");
  //console.log("mouse up , etat : " + state);
  // console.log("rangeSliderTrackEndCallback : " + state);
  switch (state) {
    case StateDrag.DOWN:
      {
        state = StateDrag.IDLE;
        break;
      }
    case StateDrag.DRAG:
      {
        state = StateDrag.IDLE;
        updateKnobAndVideoWrapper(e);
        // console.log("function - rangeSliderTrackEndCallback l285 state machine");
        pause();
        break;
      }
    case StateDrag.LONGPRESS:
      {
        state = StateDrag.IDLE;
        updateKnobAndVideoWrapper(e);
        stopCreateSegment(e, video.currentTime);
        break;
      }
  }
  //event.preventDefault();
};

var knobMinMouseLeaveCallback = function knobMinMouseLeaveCallback(e) {
  switch (state) {
    case StateDrag.DOWN:
      {
        state = StateDrag.DRAG;
        break;
      }
    case StateDrag.DRAG:
      {
        state = StateDrag.DRAG;
        updateKnobAndVideoWrapper(e);
        break;
      }
    case StateDrag.LONGPRESS:
      {
        state = StateDrag.IDLE;
        updateKnobAndVideoWrapper(e);
        stopCreateSegment(e, video.currentTime);
        break;
      }

  }
  //event.preventDefault();
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInN0YXRlTWFjaGluZUNyZWF0ZVNlZ21lbnQuanMiXSwibmFtZXMiOlsidmlkZW8iLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwidmlkZW9fanMiLCJ3cmFwcGVyQ29tbWFuZEFuZFJhbmdlIiwia25vYk1pbiIsInJhbmdlU2xpZGVyVHJhY2siLCJrbm9iTWF4Iiwid3JhcHBlclJhbmdlclNsaWRlciIsInNwZWVkcmF0ZSIsImxvbmdQcmVzc0RlbGF5IiwiV0lEVEhfS05PQiIsIlN0YXRlRHJhZyIsIklETEUiLCJET1dOIiwiRFJBRyIsIkxPTkdQUkVTUyIsInN0YXRlIiwic2VnbWVudEZlZWRiYWNrIiwid2lkdGgiLCJzdGFydFBvc3Rpb24iLCJlbmRQb3NpdGlvbiIsInN0YXJ0RHVyYXRpb25WaWRlbyIsImVuZER1cmF0aW9uVmlkZW8iLCJkaXNwbGF5ZWQiLCJkaXZHcmFwaGljYWxPYmplY3QiLCJuYXZpZ2F0b3IiLCJ1c2VyQWdlbnQiLCJtYXRjaCIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwia25vYk1pblVwQ2FsbGJhY2siLCJwYXNzaXZlIiwia25vYk1pbkNsaWNrIiwia25vYk1pbk1vdmUiLCJzZXRBdHRyaWJ1dGUiLCJwYXVzZSIsImxvbmdwcmVzc0NyZWF0ZVNlZ21lbnRDYWxsYmFjayIsInJhbmdsZXJTbGlkZXJUcmFja0NsaWNrIiwicmFuZ2VTbGlkZXJUcmFja0VuZENhbGxiYWNrIiwidmlkZW9Ub3VjaE1vdmVDYWxsYmFjayIsInByZXZlbnREZWZhdWx0Iiwic3RhcnRDcmVhdGVTZWdtZW50IiwiY3VycmVudFRpbWUiLCJjbGVhckFsbFRpbWVyIiwidXBkYXRlS25vYkFuZFZpZGVvV3JhcHBlciIsImZlZWRiYWNrT25TbGlkZXJWaWRlbyIsInBsYXkiLCJzdG9wQ3JlYXRlU2VnbWVudCIsInN0YXJ0U2VnbWVudCIsInBhcnNlSW50Iiwic3R5bGUiLCJsZWZ0IiwicG9zaXRpb24iLCJiYWNrZ3JvdW5kIiwidmlzaWJpbGl0eSIsInVwZGF0ZVNlZ21lbnRGZWVkYmFjayIsInN0b3BTZWdtZW50IiwidGltZXJMaWZlU2VnbWVudCIsIndpbmRvdyIsInNldFRpbWVvdXQiLCJjbGVhclRpbWVvdXQiLCJzdGFydFAiLCJXSURUSF9NSURfS05PQl9NSU4iLCJlbmRQIiwiUGxheWVyIiwiY3JlYXRlTmV3Q2FyZCIsIm1hcmdpbkxlZnQiLCJNYXRoIiwiYWJzIiwia25vYk1pbk1vdXNlTGVhdmVDYWxsYmFjayJdLCJtYXBwaW5ncyI6Ijs7QUFBQTtBQUNBLElBQUlBLFFBQVFDLFNBQVNDLGNBQVQsQ0FBd0IsVUFBeEIsQ0FBWjtBQUNBLElBQUlDLFdBQVdGLFNBQVNDLGNBQVQsQ0FBd0IsVUFBeEIsQ0FBZjs7QUFFQSxJQUFJRSx5QkFBeUJILFNBQVNDLGNBQVQsQ0FBd0IsMEJBQXhCLENBQTdCO0FBQ0EsSUFBSUcsVUFBVUosU0FBU0MsY0FBVCxDQUF3Qix5QkFBeEIsQ0FBZDtBQUNBLElBQUlJLG1CQUFtQkwsU0FBU0MsY0FBVCxDQUF3QixrQkFBeEIsQ0FBdkI7QUFDQSxJQUFJSyxVQUFVTixTQUFTQyxjQUFULENBQXdCLHlCQUF4QixDQUFkO0FBQ0EsSUFBSU0sc0JBQXNCUCxTQUFTQyxjQUFULENBQXdCLHNCQUF4QixDQUExQjs7QUFFQTtBQUNBLElBQUlPLFlBQVksQ0FBaEI7QUFDQSxJQUFJQyxpQkFBaUIsS0FBckI7O0FBRUEsSUFBSUMsYUFBYSxFQUFqQjs7QUFFQTtBQUNBLElBQUlDLFlBQVk7QUFDZEMsUUFBTSxDQURRO0FBRWRDLFFBQU0sQ0FGUTtBQUdkQyxRQUFNLENBSFE7QUFJZEMsYUFBVztBQUpHLENBQWhCO0FBTUEsSUFBSUMsUUFBUUwsVUFBVUMsSUFBdEI7O0FBRUE7QUFDQSxJQUFJSyxrQkFBa0I7QUFDcEJDLFNBQU8sRUFEYTtBQUVwQkMsZ0JBQWMsRUFGTTtBQUdwQkMsZUFBYSxFQUhPO0FBSXBCQyxzQkFBb0IsRUFKQTtBQUtwQkMsb0JBQWtCLEVBTEU7QUFNcEJDLGFBQVcsS0FOUztBQU9wQkMsc0JBQW9CeEIs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TCxVQUFVQyxJQUFsQjtBQUNBZ0Msa0NBQTBCZixDQUExQjtBQUNBO0FBQ0FNO0FBQ0E7QUFDRDtBQUNELFNBQUt4QixVQUFVSSxTQUFmO0FBQ0E7QUFDRUMsZ0JBQVFMLFVBQVVDLElBQWxCO0FBQ0FnQyxrQ0FBMEJmLENBQTFCO0FBQ0FrQiwwQkFBa0JsQixDQUFsQixFQUFxQjlCLE1BQU0yQyxXQUEzQjtBQUNBO0FBQ0Q7QUFwQkg7QUFzQkE7QUFDRCxDQTNCRDs7QUE2QkEsSUFBSTJCLDRCQUE0QixTQUE1QkEseUJBQTRCLENBQVN4QyxDQUFULEVBQVk7QUFDMUMsVUFBUWIsS0FBUjtBQUNFLFNBQUtMLFVBQVVFLElBQWY7QUFDQTtBQUNFRyxnQkFBUUwsVUFBVUcsSUFBbEI7QUFDQTtBQUNEO0FBQ0QsU0FBS0gsVUFBVUcsSUFBZjtBQUNBO0FBQ0VFLGdCQUFRTCxVQUFVRyxJQUFsQjtBQUNBOEIsa0NBQTBCZixDQUExQjtBQUNBO0FBQ0Q7QUFDRCxTQUFLbEIsVUFBVUksU0FBZjtBQUNBO0FBQ0VDLGdCQUFRTCxVQUFVQyxJQUFsQjtBQUNBZ0Msa0NBQTBCZixDQUExQjtBQUNBa0IsMEJBQWtCbEIsQ0FBbEIsRUFBcUI5QixNQUFNMkMsV0FBM0I7QUFDQTtBQUNEOztBQWxCSDtBQXFCQTtBQUNELENBdkJEIiwiZmlsZSI6InN0YXRlTWFjaGluZUNyZWF0ZVNlZ21lbnQuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvL0dyYXBoaWNhbCBvYmplY3RcbnZhciB2aWRlbyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidmlkZW9FQVRcIik7XG52YXIgdmlkZW9fanMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInZpZGVvRUFUXCIpO1xuXG52YXIgd3JhcHBlckNvbW1hbmRBbmRSYW5nZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwid3JhcHBlckNvbW1hbmRBbmRSYW5nZWlkXCIpO1xudmFyIGtub2JNaW4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInJhbmdlLXNsaWRlcl9oYW5kbGUtbWluXCIpO1xudmFyIHJhbmdlU2xpZGVyVHJhY2sgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInJhbmdlU2xpZGVyVHJhY2tcIik7XG52YXIga25vYk1heCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicmFuZ2Utc2xpZGVyX2hhbmRsZS1tYXhcIik7XG52YXIgd3JhcHBlclJhbmdlclNsaWRlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicmFuZ2Utc2xpZGVyLXdyYXBwZXJcIik7XG5cbi8vT3B0aW9uIGZvciB0aGUgbG9uZ3ByZXNzIGFuZCB0aGUgc3BlZWQgb2YgdGhlIHZpZGVvXG52YXIgc3BlZWRyYXRlID0gMTtcbnZhciBsb25nUHJlc3NEZWxheSA9IFwiNTAwXCI7XG5cbnZhciBXSURUSF9LTk9CID0gMzA7XG5cbi8vU3RhdGUgZm9yIHRoZSBjcmVhdGlvbiBvZiBzZWdtZW50IGJ5IERyYWcgYW5kIGRyb3BcbmxldCBTdGF0ZURyYWcgPSB7XG4gIElETEU6IDAsXG4gIERPV046IDEsXG4gIERSQUc6IDIsXG4gIExPTkdQUkVTUzogM1xufTtcbnZhciBzdGF0ZSA9IFN0YXRlRHJhZy5JRExFO1xuXG4vL0dyYXBoaWNhbCBvYmplY3Qgb2YgZmVlZGJhY2tcbnZhciBzZWdtZW50RmVlZGJhY2sgPSB7XG4gIHdpZHRoOiBcIlwiLFxuICBzdGFydFBvc3Rpb246IFwiXCIsXG4gIGVuZFBvc2l0aW9uOiBcIlwiLFxuICBzdGFydER1cmF0aW9uVmlkZW86IFwiXCIsXG4gIGVuZER1cmF0aW9uVmlkZW86IFwiXCIsXG4gIGRpc3BsYXllZDogZmFsc2UsXG4gIGRpdkdyYXBoaWNhbE9iamVjdDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzZWdtZW50TWluTWF4XCIpXG59O1xuXG5pZiAoIW5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL0FuZHJvaWR8QmxhY2tCZXJyeXxpUGhvbmV8aVBhZHxpUG9kfE9wZXJhIE1pbml8SUVNb2JpbGUvaSkpIHtcbiAgXG4gIGlmKGtub2JNaW4gIT0gbnVsbCl7XG4gICAgLy9Nb3VzZVxuICAgIGtub2JNaW4uYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNldXBcIiwgZnVuY3Rpb24oZSkge1xuICAgICAga25vYk1pblVwQ2FsbGJhY2soZSk7XG4gICAgfSwge1xuICAgICAgcGFzc2l2ZTogdHJ1ZVxuICAgIH0pO1xuICAgIGtub2JNaW4uYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCBmdW5jdGlvbihlKSB7XG4gICAgICBrbm9iTWluQ2xpY2soZSk7XG4gICAgfSwge1xuICAgICAgcGFzc2l2ZTogdHJ1ZVxuICAgIH0pO1xuICAgIGtub2JNaW4uYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCBmdW5jdGlvbihlKSB7XG4gICAgICBrbm9iTWluTW92ZShlKTtcbiAgICB9LCB7XG4gICAgICBwYXNzaXZlOiB0cnVlXG4gICAgfSk7XG4gIFxuICAgIC8qLS0tLS1NT1VTRSBMT05HIFBSRVNTLS0tLS0tLSovXG4gICAga25vYk1pbi5zZXRBdHRyaWJ1dGUoXCJkYXRhLWxvbmctcHJlc3MtZGVsYXlcIiwgbG9uZ1ByZXNzRGVsYXkpO1xuICAgIGtub2JNaW4uYWRkRXZlbnRMaXN0ZW5lcignbG9uZy1wcmVzcycsIGZ1bmN0aW9uKGUpIHtcbiAgICAgIC8vIGNvbnNvbGUubG9nKCdrbm9iTWluLmFkZEV2ZW50TGlzdGVuZXIobG9uZ3ByZXNzJyk7XG4gICAgICBwYXVzZSgpO1xuICAgICAgbG9uZ3ByZXNzQ3JlYXRlU2VnbWVudENhbGxiYWNrKGUpO1xuICAgIH0pO1xuICAgIFxuICB9XG4gIGlmKHJhbmdlU2xpZGVyVHJhY2sgIT0gbnVsbCl7XG4gIFxuICAgIHJhbmdlU2xpZGVyVHJhY2suYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCBmdW5jdGlvbihlKSB7XG4gICAgICByYW5nbGVyU2xpZGVyVHJhY2tDbGljayhlKTtcbiAgICB9LCB7XG4gICAgICBwYXNzaXZlOiB0cnVlXG4gICAgfSk7XG4gICAgcmFuZ2VTbGlkZXJUcmFjay5hZGRFdmVudExpc3RlbmVyKFwibW91c2VVcFwiLCBmdW5jdGlvbihlKSB7XG4gICAgICByYW5nZVNsaWRlclRyYWNrRW5kQ2FsbGJhY2soZSk7XG4gICAgfSwge1xuICAgICAgcGFzc2l2ZTogdHJ1ZVxuICAgIH0pO1xuICAgIHJhbmdlU2xpZGVyVHJhY2suYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCBmdW5jdGlvbihlKSB7XG4gICAgICBrbm9iTWluTW92ZShlKTtcbiAgICB9LCB7XG4gICAgICBwYXNzaXZlOiB0cnVlXG4gICAgfSk7XG4gIFxuICAgIHJhbmdlU2xpZGVyVHJhY2suYWRkRXZlbnRMaXN0ZW5lcihcImxvbmctcHJlc3NcIiwgZnVuY3Rpb24oZSkge1xuICAgICAgLy8gY29uc29sZS5sb2coJ3JhbmdlU2xpZGVyVHJhY2suYWRkRXZlbnRMaXN0ZW5lcihsb25ncHJlc3MnKTtcbiAgICAgIHBhdXNlKCk7XG4gICAgICBsb25ncHJlc3NDcmVhdGVTZWdtZW50Q2FsbGJhY2soZSk7XG4gICAgfSwgZmFsc2UpO1xuICB9XG4gIGlmKHdyYXBwZXJSYW5nZXJTbGlkZXIgIT0gbnVsbCl7XG4gIFxuICAgIHdyYXBwZXJSYW5nZXJTbGlkZXIuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCBmdW5jdGlvbihlKSB7XG4gICAgICBrbm9iTWluTW92ZShlKTtcbiAgICB9LCB0cnVlKTtcbiAgXG4gICAgd3JhcHBlclJhbmdlclNsaWRlci5hZGRFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCBmdW5jdGlvbihlKSB7XG4gICAgICByYW5nZVNsaWRlclRyYWNrRW5kQ2FsbGJhY2soZSk7XG4gICAgfSwgdHJ1ZSk7XG4gIH1cbiAgXG4gIFxuICBcbn0gZWxzZSB7XG4gIGlmKGtub2JNaW4gIT0gbnVsbCkge1xuICBcbiAgICAvL1RvdWNoXG4gICAga25vYk1pbi5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hzdGFydFwiLCBmdW5jdGlvbiAoZSkge1xuICAgICAga25vYk1pbkNsaWNrKGUpO1xuICAgIH0sIHtcbiAgICAgIHBhc3NpdmU6IHRydWVcbiAgICB9KTtcbiAgICBrbm9iTWluLmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaG1vdmVcIiwgZnVuY3Rpb24gKGUpIHtcbiAgICAgIGtub2JNaW5Nb3ZlKGUpO1xuICAgIH0sIHtcbiAgICAgIHBhc3NpdmU6IHRydWVcbiAgICB9KTtcbiAgICBrbm9iTWluLmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaGVuZFwiLCBmdW5jdGlvbiAoZSkge1xuICAgICAga25vYk1pblVwQ2FsbGJhY2soZSk7XG4gICAgfSwge1xuICAgICAgcGFzc2l2ZTogdHJ1ZVxuICAgIH0pO1xuICBcbiAgICAvKi0tLS0tTU9VU0UgTE9ORyBQUkVTUy0tLS0tLS0qL1xuICAgIGtub2JNaW4uc2V0QXR0cmlidXRlKFwiZGF0YS1sb25nLXByZXNzLWRlbGF5XCIsIGxvbmdQcmVzc0RlbGF5KTtcbiAgICBrbm9iTWluLmFkZEV2ZW50TGlzdGVuZXIoJ2xvbmctcHJlc3MnLCBmdW5jdGlvbihlKSB7XG4gICAgICAvLyBjb25zb2xlLmxvZygna25vYk1pbi5hZGRFdmVudExpc3RlbmVyKGxvbmdwcmVzcycpO1xuICAgICAgcGF1c2UoKTtcbiAgICAgIGxvbmdwcmVzc0NyZWF0ZVNlZ21lbnRDYWxsYmFjayhlKTtcbiAgICB9KTtcbiAgfVxuICAgIGlmKHJhbmdlU2xpZGVyVHJhY2sgIT0gbnVsbCl7XG4gICAgXG4gICAgXG4gICAgcmFuZ2VTbGlkZXJUcmFjay5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hzdGFydFwiLCBmdW5jdGlvbihlKSB7XG4gICAgICByYW5nbGVyU2xpZGVyVHJhY2tDbGljayhlKTtcbiAgICB9LCB7XG4gICAgICBwYXNzaXZlOiB0cnVlXG4gICAgfSk7XG4gICAgcmFuZ2VTbGlkZXJUcmFjay5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hlbmRcIiwgZnVuY3Rpb24oZSkge1xuICAgICAgcmFuZ2VTbGlkZXJUcmFja0VuZENhbGxiYWNrKGUpO1xuICAgIH0sIHtcbiAgICAgIHBhc3NpdmU6IHRydWVcbiAgICB9KTtcbiAgXG4gICAgICByYW5nZVNsaWRlclRyYWNrLmFkZEV2ZW50TGlzdGVuZXIoXCJsb25nLXByZXNzXCIsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ3JhbmdlU2xpZGVyVHJhY2suYWRkRXZlbnRMaXN0ZW5lcihsb25ncHJlc3MnKTtcbiAgICAgICAgcGF1c2UoKTtcbiAgICAgICAgbG9uZ3ByZXNzQ3JlYXRlU2VnbWVudENhbGxiYWNrKGUpO1xuICAgICAgfSwgZmFsc2UpO1xuICB9XG4gIGlmKHZpZGVvICE9bnVsbCl7XG4gIFxuICAgIHZpZGVvLmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaG1vdmVcIiwgZnVuY3Rpb24oZSkge1xuICAgICAgdmlkZW9Ub3VjaE1vdmVDYWxsYmFjayhlKTtcbiAgICB9LCB7XG4gICAgICBwYXNzaXZlOiB0cnVlXG4gICAgfSk7XG4gIH1cbiAgaWYodmlkZW9fanMgIT0gbnVsbCl7XG4gIFxuICAgIHZpZGVvX2pzLmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaG1vdmVcIiwgZnVuY3Rpb24oZSkge1xuICAgICAgdmlkZW9Ub3VjaE1vdmVDYWxsYmFjayhlKTtcbiAgICB9LCB7XG4gICAgICBwYXNzaXZlOiB0cnVlXG4gICAgfSk7XG4gIH1cbn1cblxuXG4vKndpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCBmdW5jdGlvbihlKXtcbiAgcmFuZ2VTbGlkZXJUcmFja0VuZENhbGxiYWNrKGUpO1xufSwgZmFsc2UpO1xud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIiwgZnVuY3Rpb24oZSl7XG4gIGtub2JNaW5Nb3ZlKGUpO1xufSx0cnVlICk7Ki9cblxuXG5cblxuXG4vKkNhbGxiYWNrIGZ1bmN0aW9uKi9cbnZhciBsb25ncHJlc3NDcmVhdGVTZWdtZW50Q2FsbGJhY2sgPSBmdW5jdGlvbihlKSB7XG4gIGUucHJldmVudERlZmF1bHQoKTtcbiAgc3dpdGNoIChzdGF0ZSkge1xuICAgIGNhc2UgU3RhdGVEcmFnLkRPV046XG4gICAge1xuICAgICAgXG4gICAgICBzdGF0ZSA9IFN0YXRlRHJhZy5MT05HUFJFU1M7XG4gICAgICAvL3BhdXNlKCk7XG4gICAgICBzdGFydENyZWF0ZVNlZ21lbnQoZSwgdmlkZW8uY3VycmVudFRpbWUpO1xuICAgICAgYnJlYWs7XG4gICAgfVxuICAgIFxuICB9XG4gIC8vZXZlbnQucHJldmVudERlZmF1bHQoKTtcbn07XG5cbnZhciB2aWRlb1RvdWNoTW92ZUNhbGxiYWNrID0gZnVuY3Rpb24oZSkge1xuICBzd2l0Y2ggKHN0YXRlKSB7XG4gICAgY2FzZSBTdGF0ZURyYWcuSURMRTpcbiAgICB7XG4gICAgICBzdGF0ZSA9IFN0YXRlRHJhZy5EUkFHO1xuICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG59O1xuXG52YXIgcmFuZ2xlclNsaWRlclRyYWNrQ2xpY2sgPSBmdW5jdGlvbihlKSB7XG4gIC8vICBjb25zb2xlLmxvZyhcInJhbmdsZXJTbGlkZXJUcmFja0NsaWNrIHN0YXRlIDogXCIgKyBzdGF0ZSk7XG4gIC8vIHBhdXNlKCk7XG4gIHN3aXRjaCAoc3RhdGUpIHtcbiAgICBjYXNlIFN0YXRlRHJhZy5JRExFOlxuICAgIHtcbiAgICAgIHN0YXRlID0gU3RhdGVEcmFnLkRPV047XG4gICAgICBjbGVhckFsbFRpbWVyKCk7XG4gICAgICB1cGRhdGVLbm9iQW5kVmlkZW9XcmFwcGVyKGUpO1xuICAgICAgZmVlZGJhY2tPblNsaWRlclZpZGVvKGZhbHNlKTtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuICAvL2NvbnNvbGUubG9nKFwiZnVuY3Rpb24gLSByYW5nbGVyU2xpZGVyVHJhY2tDbGljayBhcHBlbCBwbGF5IGwxNDcgc3RhdGVtYWNoaW5lIFwiKTtcbiAgcGxheSgpO1xufTtcblxudmFyIGtub2JNaW5VcENhbGxiYWNrID0gZnVuY3Rpb24oZSkge1xuICAvL2NvbnNvbGUubG9nKFwiKioqa25vYk1pblVwQ2FsbGJhY2sgKioqIFwiKyBzdGF0ZSk7XG4gIHN3aXRjaCAoc3RhdGUpIHtcbiAgICBjYXNlIFN0YXRlRHJhZy5JRExFOlxuICAgIHtcbiAgICAgIHN0YXRlID0gU3RhdGVEcmFnLklETEU7XG4gICAgICAvL2NvbnNvbGUubG9nKFwiZnVuY3Rpb24gLSBrbm9iTWluVXBDYWxsYmFjayBhcHBlbCBwbGF5IFwiKTtcbiAgICAgIC8vcGxheSgpO1xuICAgICAgYnJlYWs7XG4gICAgfVxuICAgIGNhc2UgU3RhdGVEcmFnLkxPTkdQUkVTUzpcbiAgICB7XG4gICAgICBzdGF0ZSA9IFN0YXRlRHJhZy5JRExFO1xuICAgICAgdXBkYXRlS25vYkFuZFZpZGVvV3JhcHBlcihlKTtcbiAgICAgIHN0b3BDcmVhdGVTZWdtZW50KGUsIHZpZGVvLmN1cnJlbnRUaW1lKTtcbiAgICAgIC8vY29uc29sZS5sb2coXCJmdW5jdGlvbiAtIGtub2JNaW5VcENhbGxiYWNrIGFwcGVsIHBhdXNlIGwxNjQgc3RhdGVtYWNoaW5lIFwiKTtcbiAgICAgIHBsYXkoKTtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgICBjYXNlIFN0YXRlRHJhZy5EUkFHOlxuICAgIHtcbiAgICAgIHN0YXRlID0gU3RhdGVEcmFnLklETEU7XG4gICAgICB1cGRhdGVLbm9iQW5kVmlkZW9XcmFwcGVyKGUpO1xuICAgICAgLy9jb25zb2xlLmxvZyhcImZ1bmN0aW9uIC0ga25vYk1pblVwQ2FsbGJhY2sgYXBwZWwgcGF1c2UgbDE2NSBzdGF0ZW1hY2hpbmUgXCIpO1xuICAgICAgcGF1c2UoKTtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgICBjYXNlIFN0YXRlRHJhZy5ET1dOOlxuICAgIHtcbiAgICAgIHN0YXRlID0gU3RhdGVEcmFnLklETEU7XG4gICAgICB1cGRhdGVLbm9iQW5kVmlkZW9XcmFwcGVyKGUpO1xuICAgICAgLy9jb25zb2xlLmxvZyhcImZ1bmN0aW9uIC0ga25vYk1pblVwQ2FsbGJhY2sgYXBwZWwgcGF1c2UgbDE3MiBzdGF0ZW1hY2hpbmUgXCIpO1xuICAgICAgcGF1c2UoKTtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuICBcbiAgLy9ldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xufTtcblxuXG4vL0NyZWF0ZSBTZWdtZW50XG5mdW5jdGlvbiBzdGFydENyZWF0ZVNlZ21lbnQoZSwgc3RhcnRTZWdtZW50KSB7XG4gIGlmKHBhcnNlSW50KGtub2JNaW4uc3R5bGUubGVmdCwxMCkgPCAwKXtcbiAgICBrbm9iTWF4LnN0eWxlLmxlZnQgPSBXSURUSF9LTk9CLzIgKyBcInB4XCI7XG4gIH0gZWxzZSB7XG4gICAga25vYk1heC5zdHlsZS5sZWZ0ID0ga25vYk1pbi5zdHlsZS5sZWZ0O1xuICB9XG4gIC8vZWxzZSBpZihwYXJzZUludChrbm9iTWluLnN0eWxlLmxlZnQsMTApID4gV0lEVEhfUkFOR0VfU0xJREVSX1RSQUNLIC0gV0lEVEhfS05PQiArMSkge1xuICAvL1xuICAvLyAgICAgfVxuIFxuICBrbm9iTWF4LnN0eWxlLnBvc2l0aW9uID0gXCJhYnNvbHV0ZVwiO1xuICAvL3N0YXRlICBTdGF0ZURyYWcuTE9OR1BSRVNTO1xuICBrbm9iTWluLnN0eWxlLmJhY2tncm91bmQgPSAnIzIxM0Y4RCc7XG4gIGtub2JNYXguc3R5bGUudmlzaWJpbGl0eSA9IFwidmlzaWJsZVwiO1xuICB1cGRhdGVTZWdtZW50RmVlZGJhY2soKTtcbn1cblxuZnVuY3Rpb24gc3RvcENyZWF0ZVNlZ21lbnQoZSwgc3RvcFNlZ21lbnQpIHtcbiAgbGV0IHRpbWVyTGlmZVNlZ21lbnQgPSB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICBrbm9iTWF4LnN0eWxlLnZpc2liaWxpdHkgPSBcImhpZGRlblwiO1xuICAgIHNlZ21lbnRGZWVkYmFjay5kaXZHcmFwaGljYWxPYmplY3Quc3R5bGUudmlzaWJpbGl0eSA9IFwiaGlkZGVuXCI7XG4gICAga25vYk1pbi5zdHlsZS5iYWNrZ3JvdW5kID0gJyNmZmZmZmYnO1xuICAgIC8vY3JlYXRlQ2FyZCgpO1xuICAgIHdpbmRvdy5jbGVhclRpbWVvdXQodGltZXJMaWZlU2VnbWVudCk7XG4gICAgLy9jb25zb2xlLmxvZyhcIkFBQSA6IFwiICsgcGFyc2VJbnQoa25vYk1heC5zdHlsZS5sZWZ0LDEwKSk7XG4gICAgXG4gICAgXG4gICAgdmFyIHN0YXJ0UCA9IHBhcnNlSW50KGtub2JNYXguc3R5bGUubGVmdCwgMTApICsgV0lEVEhfTUlEX0tOT0JfTUlOIC8gMjtcbiAgICB2YXIgZW5kUCA9IHBhcnNlSW50KGtub2JNaW4uc3R5bGUubGVmdCwgMTApICsgV0lEVEhfS05PQjtcbiAgICBcbiAgIC8vIGNhcmRNYW5hZ2VyLmV4ZWN1dGUobmV3IENyZWF0ZU5ld0NhcmRDb21tYW5kKHN0YXJ0UCwgZW5kUCkpO1xuICAgIGlmKHN0YXJ0UCA8IDApe1xuICAgICAgc3RhcnRQID0gMDtcbiAgICB9XG5cbiAgICBQbGF5ZXIuY3JlYXRlTmV3Q2FyZChzdGFydFAsZW5kUCApO1xuICAgIFxuICAgIHBsYXkoKTtcbiAgfSwgNzAwKTtcbn1cblxuXG5cblxuLy9VcGRhdGUgdGhlIGZlZWRiYWNrIG9mIHRoZSBjcmVhdGlvbiBvZiBhIHNlZ21lbnQgYWZ0ZXIgYSBsb25nIHByZXNzXG5mdW5jdGlvbiB1cGRhdGVTZWdtZW50RmVlZGJhY2soKSB7XG4gIFxuICBcbiAgXG4gIGlmIChwYXJzZUludChrbm9iTWluLnN0eWxlLmxlZnQsIDEwKSA+IHBhcnNlSW50KGtub2JNYXguc3R5bGUubGVmdCwgMTApKSB7XG4gICAgc2VnbWVudEZlZWRiYWNrLmRpdkdyYXBoaWNhbE9iamVjdC5zdHlsZS5tYXJnaW5MZWZ0ID0ga25vYk1heC5zdHlsZS5sZWZ0ICAgO1xuICAgIHNlZ21lbnRGZWVkYmFjay5kaXZHcmFwaGljYWxPYmplY3Quc3R5bGUud2lkdGggPSBNYXRoLmFicygocGFyc2VJbnQoa25vYk1pbi5zdHlsZS5sZWZ0LCAxMCkgLSBwYXJzZUludChrbm9iTWF4LnN0eWxlLmxlZnQsIDEwKSAgICkpICsgV0lEVEhfS05PQiArIFwicHhcIjtcbiAgXG4gIH0gZWxzZSB7XG4gICAgc2VnbWVudEZlZWRiYWNrLmRpdkdyYXBoaWNhbE9iamVjdC5zdHlsZS5tYXJnaW5MZWZ0ID0ga25vYk1pbi5zdHlsZS5sZWZ0ICAgIDtcbiAgICBzZWdtZW50RmVlZGJhY2suZGl2R3JhcGhpY2FsT2JqZWN0LnN0eWxlLndpZHRoID0gTWF0aC5hYnMoKHBhcnNlSW50KGtub2JNaW4uc3R5bGUubGVmdCwgMTApIC0gcGFyc2VJbnQoa25vYk1heC5zdHlsZS5sZWZ0LCAxMCkgICApKSAgKyBcInB4XCI7XG4gIFxuICB9XG4gIHNlZ21lbnRGZWVkYmFjay5kaXZHcmFwaGljYWxPYmplY3Quc3R5bGUudmlzaWJpbGl0eSA9IFwidmlzaWJsZVwiO1xuICBcbiAgXG4gIGlmKHBhcnNlSW50KHNlZ21lbnRGZWVkYmFjay5kaXZHcmFwaGljYWxPYmplY3Quc3R5bGUubWFyZ2luTGVmdCwgMTApIDwgMCApe1xuICAgIC8vdGhlIGNhc2UgaWYgdGhlIGtub2IgaXMgaW4gdGhlIGV4dHJlbXVuIG9mIHRoZSBsb2FkZXIuXG4gICAgc2VnbWVudEZlZWRiYWNrLmRpdkdyYXBoaWNhbE9iamVjdC5zdHlsZS5tYXJnaW5MZWZ0ID0gXCIgMCBweFwiIDtcbiAgfVxuICBcbn1cblxuXG4vKlxuXG4vL3N0YXJ0IHBvc2l0aW9uIG9uIHRoZSBzbGlkZXIgYW5kIGVuZCBwb3NpdGlvbiBvbiB0aGUgc2xpZGVyXG5mdW5jdGlvbiB2aWRlb1RvU2xpZGVyKHN0YXJ0RHVyYXRpb25WaWRlbywgZW5kRHVyYXRpb25WaWRlbykge1xuICB2YXIgc3RhcnRQID0gTWF0aC5yb3VuZCgoKHN0YXJ0RHVyYXRpb25WaWRlbyAqIE5VTUJFUl9PRl9USUNLKSAvIHZpZGVvLmR1cmF0aW9uKSAtIHJhbmdlU2xpZGVyVHJhY2sub2Zmc2V0TGVmdCk7XG4gIHZhciBlbmRQID0gTWF0aC5yb3VuZCgoKGVuZER1cmF0aW9uVmlkZW8gKiBOVU1CRVJfT0ZfVElDSykgLyB2aWRlby5kdXJhdGlvbikgLSByYW5nZVNsaWRlclRyYWNrLm9mZnNldExlZnQpO1xuICByZXR1cm4ge1xuICAgIHN0YXJ0UG9zaXRpb246IHN0YXJ0UCxcbiAgICBlbmRQb3NpdGlvbjogZW5kUFxuICB9O1xufVxuKi9cblxudmFyIGtub2JNaW5Nb3ZlID0gZnVuY3Rpb24oZSkge1xuICBzd2l0Y2ggKHN0YXRlKSB7XG4gICAgY2FzZSBTdGF0ZURyYWcuRE9XTjpcbiAgICB7XG4gICAgICBzdGF0ZSA9IFN0YXRlRHJhZy5EUkFHO1xuICAgICAgLy9jb25zb2xlLmxvZyhcIiBkcmFnaW5nIGV0YXQgZG93blwiKTtcbiAgICAgIHVwZGF0ZUtub2JBbmRWaWRlb1dyYXBwZXIoZSk7XG4gICAgICBicmVhaztcbiAgICB9XG4gICAgY2FzZSBTdGF0ZURyYWcuRFJBRzpcbiAgICB7XG4gICAgICBzdGF0ZSA9IFN0YXRlRHJhZy5EUkFHO1xuICAgICAgdXBkYXRlS25vYkFuZFZpZGVvV3JhcHBlcihlKTtcbiAgICAgIC8vY29uc29sZS5sb2coXCIgZHJhZ2luZyBldGF0IGRyYWdcIik7XG4gICAgICBicmVhaztcbiAgICB9XG4gICAgY2FzZSBTdGF0ZURyYWcuTE9OR1BSRVNTOlxuICAgIHtcbiAgICAgIHN0YXRlID0gU3RhdGVEcmFnLkxPTkdQUkVTUztcbiAgICAgIC8vY29uc29sZS5sb2coXCJzdGF0ZSBsb25ncHJlc3Mgd2l0aCBtb3VzZSBtb3ZlXCIpO1xuICAgICAgdXBkYXRlS25vYkFuZFZpZGVvV3JhcHBlcihlKTtcbiAgICAgIHVwZGF0ZVNlZ21lbnRGZWVkYmFjaygpO1xuICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG59O1xuXG5cbnZhciBrbm9iTWluQ2xpY2sgPSBmdW5jdGlvbihlKSB7XG4gIC8vY29uc29sZS5sb2coXCJmdW5jdGlvbiAtIGtub2JNaW5DbGlja1wiICk7XG4gIHBhdXNlKCk7XG4gIC8vVXBkYXRlIHZpZGVvIHBvc2l0aW9uXG4gIHN3aXRjaCAoc3RhdGUpIHtcbiAgICBjYXNlIFN0YXRlRHJhZy5JRExFOlxuICAgIHtcbiAgICAgIHN0YXRlID0gU3RhdGVEcmFnLkRPV047XG4gICAgICBjbGVhckFsbFRpbWVyKCk7XG4gICAgICBicmVhaztcbiAgICB9XG4gIH1cbiAgLy9lLnByZXZlbnREZWZhdWx0KCk7XG59O1xuXG5cbnZhciByYW5nZVNsaWRlclRyYWNrRW5kQ2FsbGJhY2sgPSBmdW5jdGlvbihlKSB7XG4gIC8vY29uc29sZS5sb2coXCJcIik7XG4gIC8vY29uc29sZS5sb2coXCJtb3VzZSB1cCAsIGV0YXQgOiBcIiArIHN0YXRlKTtcbiAgLy8gY29uc29sZS5sb2coXCJyYW5nZVNsaWRlclRyYWNrRW5kQ2FsbGJhY2sgOiBcIiArIHN0YXRlKTtcbiAgc3dpdGNoIChzdGF0ZSkge1xuICAgIGNhc2UgU3RhdGVEcmFnLkRPV046XG4gICAge1xuICAgICAgc3RhdGUgPSBTdGF0ZURyYWcuSURMRTtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgICBjYXNlIFN0YXRlRHJhZy5EUkFHOlxuICAgIHtcbiAgICAgIHN0YXRlID0gU3RhdGVEcmFnLklETEU7XG4gICAgICB1cGRhdGVLbm9iQW5kVmlkZW9XcmFwcGVyKGUpO1xuICAgICAgLy8gY29uc29sZS5sb2coXCJmdW5jdGlvbiAtIHJhbmdlU2xpZGVyVHJhY2tFbmRDYWxsYmFjayBsMjg1IHN0YXRlIG1hY2hpbmVcIik7XG4gICAgICBwYXVzZSgpO1xuICAgICAgYnJlYWs7XG4gICAgfVxuICAgIGNhc2UgU3RhdGVEcmFnLkxPTkdQUkVTUzpcbiAgICB7XG4gICAgICBzdGF0ZSA9IFN0YXRlRHJhZy5JRExFO1xuICAgICAgdXBkYXRlS25vYkFuZFZpZGVvV3JhcHBlcihlKTtcbiAgICAgIHN0b3BDcmVhdGVTZWdtZW50KGUsIHZpZGVvLmN1cnJlbnRUaW1lKTtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuICAvL2V2ZW50LnByZXZlbnREZWZhdWx0KCk7XG59O1xuXG52YXIga25vYk1pbk1vdXNlTGVhdmVDYWxsYmFjayA9IGZ1bmN0aW9uKGUpIHtcbiAgc3dpdGNoIChzdGF0ZSkge1xuICAgIGNhc2UgU3RhdGVEcmFnLkRPV046XG4gICAge1xuICAgICAgc3RhdGUgPSBTdGF0ZURyYWcuRFJBRztcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgICBjYXNlIFN0YXRlRHJhZy5EUkFHOlxuICAgIHtcbiAgICAgIHN0YXRlID0gU3RhdGVEcmFnLkRSQUc7XG4gICAgICB1cGRhdGVLbm9iQW5kVmlkZW9XcmFwcGVyKGUpO1xuICAgICAgYnJlYWs7XG4gICAgfVxuICAgIGNhc2UgU3RhdGVEcmFnLkxPTkdQUkVTUzpcbiAgICB7XG4gICAgICBzdGF0ZSA9IFN0YXRlRHJhZy5JRExFO1xuICAgICAgdXBkYXRlS25vYkFuZFZpZGVvV3JhcHBlcihlKTtcbiAgICAgIHN0b3BDcmVhdGVTZWdtZW50KGUsIHZpZGVvLmN1cnJlbnRUaW1lKTtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgICBcbiAgfVxuICAvL2V2ZW50LnByZXZlbnREZWZhdWx0KCk7XG59O1xuXG4iXX0=