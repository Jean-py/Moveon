'use strict';

var cardFunctionalCore = new CardFunctionalCore();

function Card(startDurationParam, endDurationParam, startPositionParam, endPositionParam, cardInfo) {
  var description = '';

  //Propriété de style
  var width = '6%';
  var height = '6%';
  var deleted = false;
  var iDiv = null;
  var startP = startPositionParam;
  var endP = endPositionParam;
  //Valeur pour jouer la carte
  var speed = 1;
  var repetitionNumber = 1;
  //div used
  var divInfoCard = null;
  //let selectSpeed=null;
  var selectNbRepet = null;
  var selectSpeed = null;

  var imgSlow = null;

  var textSegment = null;
  var imgRepet = null;
  var divSegment = null;
  var startDuration = startDurationParam;
  var endDuration = endDurationParam;
  var left = void 0;

  var buttonDelete = null;
  var cardObject;

  //cette div est la principale, celle qui contient fragment + bardFragment
  iDiv = document.createElement('div');
  iDiv.id = 'idCard' + createUniqueId();
  iDiv.className = 'segmentWrapper';
  iDiv.style.left = startPositionParam + "px";

  //Color picker
  //var arrowDown = document.createElement('input');
  /* arrowDown.type = 'jscolor';
   arrowDown.className = 'jscolor';
   arrowDown.value = '#8DFFFF';
   //jscolor.installByClassName("jscolor");*/

  /* arrowDown.border = 'none';
   arrowDown.outline = 'none';
   arrowDown.style.backgroundColor = 'black';
   arrowDown.style.webkitAppearance = 'listitem';
   arrowDown.value = "#41568d";*/

  //arrowDown.value = "FF9900";
  //arrowDown.mode = 'HS';
  //arrowDown.position = 'right' ;
  /* arrowDown.value ="#102b9f";
   arrowDown.style.outline="none";*/

  //Div du segment bleu
  divSegment = document.createElement('div');
  divSegment.className = 'segment';

  //taille de la carte initiale
  width = iDiv.style.width = parseInt(endPositionParam, 10) - parseInt(startPositionParam, 10) + "px";
  divSegment.style.width = parseInt(endPositionParam, 10) - parseInt(startPositionParam, 10) + "px";

  initGUI();
  initStyle();
  initListener();
  playCard(iDiv, startDurationParam);

  function watchColorPicker(event) {
    divSegment.style.backgroundColor = event.target.value;
    console.log("color");
  }
  //console.log(cardInfo.deleted);
  function updateInfo() {
    //    console.log(description,speed,repetitionNumber);
    cardObject.width = width;
    cardObject.startP = startP;
    cardObject.endP = endP;
    cardObject.description = description;
    cardObject.speed = speed;
    cardObject.deleted = deleted;
    cardObject.repetitionNumber = repetitionNumber;
    cardObject.iDiv = iDiv;
    cardObject.id = iDiv.id;
    return cardObject;
  }

  function initListener() {
    textSegment.addEventListener('long-press', function (e) {
      createBtnDelete(e);
    });
    divSegment.addEventListener('long-press', function (e) {
      createBtnDelete(e);
    });
    selectSpeed.addEventListener("blur", function (e) {
      var speedRate = selectSpeed.options[selectSpeed.selectedIndex].value;
      speed = speedRate;
      cardFunctionalCore.execute(new CardSpeedCommand(cardObject, speedRate));
    });
    selectNbRepet.addEventListener("blur", function (e) {
      repetitionNumber = selectNbRepet.options[selectNbRepet.selectedIndex].value;
      console.log("nbrepet in card :" + repetitionNumber);
      cardFunctionalCore.execute(new CardNbRepetCommand(cardObject, repetitionNumber));
      //cardFunctionalCore.execute(new CardNbRepetCommand(cardObject, 100));
    });
    divSegment.addEventListener("mousedown", function (e) {
      repetitionNumber = selectNbRepet.options[selectNbRepet.selectedIndex].value;
      var speedRate = selectSpeed.options[selectSpeed.selectedIndex].value;
      speed = speedRate;
      segmentFeedback.startPostion = iDiv.style.left;
      segmentFeedback.width = width;
      description = textSegment.value;
      feedbackOnSliderVideo(true);
      //videoFunctionalCoreManager.execute(new RepetPartOfVideoCommand(startDuration, endDuration, repetitionNumber, speedRate));
      videoFunctionalCoreManager.execute(new RepetPartOfVideoCommand(startDuration, endDuration, 100, speedRate));
    }, false);
    //TODO widget color picker
    //arrowDown.addEventListener("change", watchColorPicker, false);
  }
  function initGUI() {
    textSegment = document.createElement('input');
    textSegment.className = 'textSegment';
    //UI button speed and slow
    imgRepet = document.createElement("img");
    imgRepet.className = 'imgRepet';
    imgSlow = document.createElement("img");

    imgSlow.className = 'imgSlow';
    selectSpeed = document.createElement("select");
    selectSpeed.className = 'selectSpeed';
    selectNbRepet = document.createElement("select");

    selectNbRepet.className = 'selectNbRepet';
    divInfoCard = document.createElement('div');

    divInfoCard.className = "infoCard";

    /*textSegment.addEventListener("focus", function () {
      cardFunctionalCore.execute(new ModifyCardDescriptionCommand(cardObject,textSegment.value));
    });*/
    textSegment.addEventListener("blur", function () {
      description = textSegment.value;
      cardFunctionalCore.execute(new ModifyCardDescriptionCommand(cardObject, textSegment.value));
    });

    for (var i = 0; i < 20; i += 1) {
      selectSpeed.add(new Option(i / 10 + ""));
    }
    selectSpeed.selectedIndex = 10;
    for (var _i = 0; _i < 20; _i++) {
      selectNbRepet.options.add(new Option(_i + ""));
    }

    selectNbRepet.selectedIndex = 1;

    //Div contenant les info du dessus (taille de div invariable)
    divInfoCard.appendChild(imgSlow);
    divInfoCard.appendChild(selectSpeed);
    //divInfoCard.appendChild(imgRepet);
    //divInfoCard.appendChild(selectNbRepet);
    divInfoCard.appendChild(textSegment);
    //divInfoCard.appendChild(arrowDown);
    iDiv.appendChild(divSegment);
    iDiv.appendChild(divInfoCard);

    //If the card have been deleted, the color is red, otherwise blue.
    if (cardInfo) {
      if (cardInfo.deleted) {
        divSegment.style.backgroundColor = "red";
      } else {
        divSegment.style.backgroundColor = "#213F8D";
      }
      textSegment.value = cardInfo.description;
      selectNbRepet.selectedIndex = cardInfo.repetitionNumber;
      selectSpeed.selectedIndex = cardInfo.speed * 10;
    }
  }

  function initStyle() {
    textSegment.style.left = divSegment.style.width;
    imgSlow.src = "/media/workshop2/card/slow.png";
    imgRepet.src = "/media/workshop2/card/repet.png";
  }

  function createBtnDelete(e) {
    e.preventDefault();
    //delete apparait
    var buttonDelete = document.createElement('button');
    buttonDelete.id = 'idBtnDelete';
    buttonDelete.style.position = "absolute";
    buttonDelete.type = "button";
    buttonDelete.innerHTML = "Delete";
    buttonDelete.style.width = "100px";
    divInfoCard.appendChild(buttonDelete);
    buttonDelete.addEventListener('mouseup', function (e) {
      //TODO
      cardManager.execute(new DeleteCardCommand(cardObject));
      //deleteCard(cardObject);
    });

    buttonDelete.addEventListener('touchend', function (e) {
      cardManager.execute(new DeleteCardCommand(cardObject));
      //deleteCard();
    });
  }

  cardObject = {
    width: width,
    startP: startP,
    endP: endP,
    description: this.description,
    speed: this.speed,
    repetitionNumber: this.repetitionNumber,
    iDiv: iDiv,
    id: iDiv.id,
    updateInfo: updateInfo
  };

  return cardObject;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNhcmQuanMiXSwibmFtZXMiOlsiY2FyZEZ1bmN0aW9uYWxDb3JlIiwiQ2FyZEZ1bmN0aW9uYWxDb3JlIiwiQ2FyZCIsInN0YXJ0RHVyYXRpb25QYXJhbSIsImVuZER1cmF0aW9uUGFyYW0iLCJzdGFydFBvc2l0aW9uUGFyYW0iLCJlbmRQb3NpdGlvblBhcmFtIiwiY2FyZEluZm8iLCJkZXNjcmlwdGlvbiIsIndpZHRoIiwiaGVpZ2h0IiwiZGVsZXRlZCIsImlEaXYiLCJzdGFydFAiLCJlbmRQIiwic3BlZWQiLCJyZXBldGl0aW9uTnVtYmVyIiwiZGl2SW5mb0NhcmQiLCJzZWxlY3ROYlJlcGV0Iiwic2VsZWN0U3BlZWQiLCJpbWdTbG93IiwidGV4dFNlZ21lbnQiLCJpbWdSZXBldCIsImRpdlNlZ21lbnQiLCJzdGFydER1cmF0aW9uIiwiZW5kRHVyYXRpb24iLCJsZWZ0IiwiYnV0dG9uRGVsZXRlIiwiY2FyZE9iamVjdCIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImlkIiwiY3JlYXRlVW5pcXVlSWQiLCJjbGFzc05hbWUiLCJzdHlsZSIsInBhcnNlSW50IiwiaW5pdEdVSSIsImluaXRTdHlsZSIsImluaXRMaXN0ZW5lciIsInBsYXlDYXJkIiwid2F0Y2hDb2xvclBpY2tlciIsImV2ZW50IiwiYmFja2dyb3VuZENvbG9yIiwidGFyZ2V0IiwidmFsdWUiLCJjb25zb2xlIiwibG9nIiwidXBkYXRlSW5mbyIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwiY3JlYXRlQnRuRGVsZXRlIiwic3BlZWRSYXRlIiwib3B0aW9ucyIsInNlbGVjdGVkSW5kZXgiLCJleGVjdXRlIiwiQ2FyZFNwZWVkQ29tbWFuZCIsIkNhcmROYlJlcGV0Q29tbWFuZCIsInNlZ21lbnRGZWVkYmFjayIsInN0YXJ0UG9zdGlvbiIsImZlZWRiYWNrT25TbGlkZXJWaWRlbyIsInZpZGVvRnVuY3Rpb25hbENvcmVNYW5hZ2VyIiwiUmVwZXRQYXJ0T2ZWaWRlb0NvbW1hbmQiLCJNb2RpZnlDYXJkRGVzY3JpcHRpb25Db21tYW5kIiwiaSIsImFkZCIsIk9wdGlvbiIsImFwcGVuZENoaWxkIiwic3JjIiwicHJldmVudERlZmF1bHQiLCJwb3NpdGlvbiIsInR5cGUiLCJpbm5lckhUTUwiLCJjYXJkTWFuYWdlciIsIkRlbGV0ZUNhcmRDb21tYW5kIl0sIm1hcHBpbmdzIjoiOztBQUFBLElBQUlBLHFCQUFxQixJQUFJQyxrQkFBSixFQUF6Qjs7QUFFQSxTQUFTQyxJQUFULENBQWVDLGtCQUFmLEVBQWtDQyxnQkFBbEMsRUFBbURDLGtCQUFuRCxFQUFzRUMsZ0JBQXRFLEVBQXdGQyxRQUF4RixFQUFrRztBQUNoRyxNQUFJQyxjQUFjLEVBQWxCOztBQUVBO0FBQ0EsTUFBSUMsUUFBUSxJQUFaO0FBQ0EsTUFBSUMsU0FBUyxJQUFiO0FBQ0EsTUFBSUMsVUFBVSxLQUFkO0FBQ0EsTUFBSUMsT0FBTyxJQUFYO0FBQ0EsTUFBSUMsU0FBU1Isa0JBQWI7QUFDQSxNQUFJUyxPQUFPUixnQkFBWDtBQUNGO0FBQ0UsTUFBSVMsUUFBUSxDQUFaO0FBQ0EsTUFBSUMsbUJBQW1CLENBQXZCO0FBQ0Y7QUFDRSxNQUFJQyxjQUFjLElBQWxCO0FBQ0E7QUFDQSxNQUFJQyxnQkFBZ0IsSUFBcEI7QUFDQSxNQUFJQyxjQUFjLElBQWxCOztBQUVBLE1BQUlDLFVBQVUsSUFBZDs7QUFFQSxNQUFJQyxjQUFjLElBQWxCO0FBQ0EsTUFBSUMsV0FBVyxJQUFmO0FBQ0EsTUFBSUMsYUFBYSxJQUFqQjtBQUNBLE1BQUlDLGdCQUFnQnJCLGtCQUFwQjtBQUNBLE1BQUlzQixjQUFjckIsZ0JBQWxCO0FBQ0EsTUFBSXNCLGFBQUo7O0FBRUEsTUFBSUMsZUFBZSxJQUFuQjtBQUNBLE1BQUlDLFVBQUo7O0FBRUE7QUFDQWhCLFNBQU9pQixTQUFTQyxhQUFULENBQXVCLEtBQXZCLENBQVA7QUFDQWxCLE9BQUttQixFQUFMLEdBQVUsV0FBV0MsZ0JBQXJCO0FBQ0FwQixPQUFLcUIsU0FBTCxHQUFpQixnQkFBakI7QUFDQXJCLE9BQUtzQixL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bGUiOiJjYXJkLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGNhcmRGdW5jdGlvbmFsQ29yZSA9IG5ldyBDYXJkRnVuY3Rpb25hbENvcmUoKTtcblxuZnVuY3Rpb24gQ2FyZCAoc3RhcnREdXJhdGlvblBhcmFtLGVuZER1cmF0aW9uUGFyYW0sc3RhcnRQb3NpdGlvblBhcmFtLGVuZFBvc2l0aW9uUGFyYW0sIGNhcmRJbmZvKSB7XG4gIHZhciBkZXNjcmlwdGlvbiA9ICcnO1xuICBcbiAgLy9Qcm9wcmnDqXTDqSBkZSBzdHlsZVxuICBsZXQgd2lkdGggPSAnNiUnO1xuICBsZXQgaGVpZ2h0ID0gJzYlJztcbiAgdmFyIGRlbGV0ZWQgPSBmYWxzZTtcbiAgdmFyIGlEaXYgPSBudWxsO1xuICB2YXIgc3RhcnRQID0gc3RhcnRQb3NpdGlvblBhcmFtO1xuICB2YXIgZW5kUCA9IGVuZFBvc2l0aW9uUGFyYW07XG4vL1ZhbGV1ciBwb3VyIGpvdWVyIGxhIGNhcnRlXG4gIHZhciBzcGVlZCA9IDE7XG4gIHZhciByZXBldGl0aW9uTnVtYmVyID0gMTtcbi8vZGl2IHVzZWRcbiAgbGV0IGRpdkluZm9DYXJkID0gbnVsbDtcbiAgLy9sZXQgc2VsZWN0U3BlZWQ9bnVsbDtcbiAgbGV0IHNlbGVjdE5iUmVwZXQgPSBudWxsO1xuICBsZXQgc2VsZWN0U3BlZWQgPSBudWxsO1xuICBcbiAgbGV0IGltZ1Nsb3cgPSBudWxsO1xuICBcbiAgdmFyIHRleHRTZWdtZW50ID0gbnVsbDtcbiAgbGV0IGltZ1JlcGV0ID0gbnVsbDtcbiAgbGV0IGRpdlNlZ21lbnQgPSBudWxsO1xuICBsZXQgc3RhcnREdXJhdGlvbiA9IHN0YXJ0RHVyYXRpb25QYXJhbTtcbiAgbGV0IGVuZER1cmF0aW9uID0gZW5kRHVyYXRpb25QYXJhbTtcbiAgbGV0IGxlZnQgO1xuICBcbiAgdmFyIGJ1dHRvbkRlbGV0ZSA9IG51bGw7XG4gIHZhciBjYXJkT2JqZWN0O1xuICBcbiAgLy9jZXR0ZSBkaXYgZXN0IGxhIHByaW5jaXBhbGUsIGNlbGxlIHF1aSBjb250aWVudCBmcmFnbWVudCArIGJhcmRGcmFnbWVudFxuICBpRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gIGlEaXYuaWQgPSAnaWRDYXJkJyArIGNyZWF0ZVVuaXF1ZUlkKCk7XG4gIGlEaXYuY2xhc3NOYW1lID0gJ3NlZ21lbnRXcmFwcGVyJztcbiAgaURpdi5zdHlsZS5sZWZ0ID0gc3RhcnRQb3NpdGlvblBhcmFtICsgXCJweFwiO1xuICBcbiAgXG4gIC8vQ29sb3IgcGlja2VyXG4gIC8vdmFyIGFycm93RG93biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XG4gLyogYXJyb3dEb3duLnR5cGUgPSAnanNjb2xvcic7XG4gIGFycm93RG93bi5jbGFzc05hbWUgPSAnanNjb2xvcic7XG4gIGFycm93RG93bi52YWx1ZSA9ICcjOERGRkZGJztcbiAgLy9qc2NvbG9yLmluc3RhbGxCeUNsYXNzTmFtZShcImpzY29sb3JcIik7Ki9cbiAgXG4gIFxuICBcbiAgLyogYXJyb3dEb3duLmJvcmRlciA9ICdub25lJztcbiAgIGFycm93RG93bi5vdXRsaW5lID0gJ25vbmUnO1xuICAgYXJyb3dEb3duLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICdibGFjayc7XG4gICBhcnJvd0Rvd24uc3R5bGUud2Via2l0QXBwZWFyYW5jZSA9ICdsaXN0aXRlbSc7XG4gICBhcnJvd0Rvd24udmFsdWUgPSBcIiM0MTU2OGRcIjsqL1xuICBcbiAgICAgLy9hcnJvd0Rvd24udmFsdWUgPSBcIkZGOTkwMFwiO1xuICAvL2Fycm93RG93bi5tb2RlID0gJ0hTJztcbiAgLy9hcnJvd0Rvd24ucG9zaXRpb24gPSAncmlnaHQnIDtcbiAvKiBhcnJvd0Rvd24udmFsdWUgPVwiIzEwMmI5ZlwiO1xuICBhcnJvd0Rvd24uc3R5bGUub3V0bGluZT1cIm5vbmVcIjsqL1xuICBcbiAgLy9EaXYgZHUgc2VnbWVudCBibGV1XG4gIGRpdlNlZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgZGl2U2VnbWVudC5jbGFzc05hbWUgPSAnc2VnbWVudCc7XG4gIFxuICAvL3RhaWxsZSBkZSBsYSBjYXJ0ZSBpbml0aWFsZVxuICB3aWR0aCA9IGlEaXYuc3R5bGUud2lkdGggPSBwYXJzZUludChlbmRQb3NpdGlvblBhcmFtLCAxMCkgLSBwYXJzZUludChzdGFydFBvc2l0aW9uUGFyYW0sIDEwKSArIFwicHhcIjtcbiAgZGl2U2VnbWVudC5zdHlsZS53aWR0aCA9IHBhcnNlSW50KGVuZFBvc2l0aW9uUGFyYW0sIDEwKSAtIHBhcnNlSW50KHN0YXJ0UG9zaXRpb25QYXJhbSwgMTApICsgXCJweFwiO1xuICBcbiAgaW5pdEdVSSgpO1xuICBpbml0U3R5bGUoKTtcbiAgaW5pdExpc3RlbmVyKCk7XG4gIHBsYXlDYXJkKGlEaXYsIHN0YXJ0RHVyYXRpb25QYXJhbSk7XG4gIFxuICBcbiAgZnVuY3Rpb24gd2F0Y2hDb2xvclBpY2tlcihldmVudCkge1xuICAgIGRpdlNlZ21lbnQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gZXZlbnQudGFyZ2V0LnZhbHVlO1xuICAgIGNvbnNvbGUubG9nKFwiY29sb3JcIik7XG4gIH1cbiAgLy9jb25zb2xlLmxvZyhjYXJkSW5mby5kZWxldGVkKTtcbiAgZnVuY3Rpb24gdXBkYXRlSW5mbygpe1xuLy8gICAgY29uc29sZS5sb2coZGVzY3JpcHRpb24sc3BlZWQscmVwZXRpdGlvbk51bWJlcik7XG4gICAgY2FyZE9iamVjdC53aWR0aCA9IHdpZHRoO1xuICAgIGNhcmRPYmplY3Quc3RhcnRQID0gc3RhcnRQO1xuICAgIGNhcmRPYmplY3QuZW5kUCA9IGVuZFA7XG4gICAgY2FyZE9iamVjdC5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uO1xuICAgIGNhcmRPYmplY3Quc3BlZWQgPSBzcGVlZDtcbiAgICBjYXJkT2JqZWN0LmRlbGV0ZWQgPSBkZWxldGVkO1xuICAgIGNhcmRPYmplY3QucmVwZXRpdGlvbk51bWJlciA9IHJlcGV0aXRpb25OdW1iZXI7XG4gICAgY2FyZE9iamVjdC5pRGl2ID0gaURpdjtcbiAgICBjYXJkT2JqZWN0LmlkID0gaURpdi5pZDtcbiAgICByZXR1cm4gY2FyZE9iamVjdDtcbiAgfVxuICBcbiAgXG4gIGZ1bmN0aW9uIGluaXRMaXN0ZW5lcigpIHtcbiAgICB0ZXh0U2VnbWVudC5hZGRFdmVudExpc3RlbmVyKCdsb25nLXByZXNzJywgZnVuY3Rpb24oZSl7XG4gICAgICBjcmVhdGVCdG5EZWxldGUoZSk7XG4gICAgfSk7XG4gICAgZGl2U2VnbWVudC5hZGRFdmVudExpc3RlbmVyKCdsb25nLXByZXNzJywgZnVuY3Rpb24oZSl7XG4gICAgICBjcmVhdGVCdG5EZWxldGUoZSk7XG4gICAgfSk7XG4gICAgc2VsZWN0U3BlZWQuYWRkRXZlbnRMaXN0ZW5lcihcImJsdXJcIiwgZnVuY3Rpb24oZSl7XG4gICAgICBsZXQgc3BlZWRSYXRlID0gc2VsZWN0U3BlZWQub3B0aW9uc1tzZWxlY3RTcGVlZC5zZWxlY3RlZEluZGV4XS52YWx1ZTtcbiAgICAgIHNwZWVkID0gc3BlZWRSYXRlO1xuICAgICAgY2FyZEZ1bmN0aW9uYWxDb3JlLmV4ZWN1dGUobmV3IENhcmRTcGVlZENvbW1hbmQoY2FyZE9iamVjdCxzcGVlZFJhdGUpKTtcbiAgICB9KTtcbiAgICBzZWxlY3ROYlJlcGV0LmFkZEV2ZW50TGlzdGVuZXIoXCJibHVyXCIsIGZ1bmN0aW9uKGUpe1xuICAgICAgcmVwZXRpdGlvbk51bWJlciA9IHNlbGVjdE5iUmVwZXQub3B0aW9uc1tzZWxlY3ROYlJlcGV0LnNlbGVjdGVkSW5kZXhdLnZhbHVlO1xuICAgICAgY29uc29sZS5sb2coXCJuYnJlcGV0IGluIGNhcmQgOlwiICsgIHJlcGV0aXRpb25OdW1iZXIpO1xuICAgICAgY2FyZEZ1bmN0aW9uYWxDb3JlLmV4ZWN1dGUobmV3IENhcmROYlJlcGV0Q29tbWFuZChjYXJkT2JqZWN0LCByZXBldGl0aW9uTnVtYmVyKSk7XG4gICAgICAvL2NhcmRGdW5jdGlvbmFsQ29yZS5leGVjdXRlKG5ldyBDYXJkTmJSZXBldENvbW1hbmQoY2FyZE9iamVjdCwgMTAwKSk7XG4gICAgfSk7XG4gICAgZGl2U2VnbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIGZ1bmN0aW9uIChlKSB7XG4gICAgICByZXBldGl0aW9uTnVtYmVyID0gc2VsZWN0TmJSZXBldC5vcHRpb25zW3NlbGVjdE5iUmVwZXQuc2VsZWN0ZWRJbmRleF0udmFsdWU7XG4gICAgICBsZXQgc3BlZWRSYXRlID0gc2VsZWN0U3BlZWQub3B0aW9uc1tzZWxlY3RTcGVlZC5zZWxlY3RlZEluZGV4XS52YWx1ZTtcbiAgICAgIHNwZWVkID0gc3BlZWRSYXRlO1xuICAgICAgc2VnbWVudEZlZWRiYWNrLnN0YXJ0UG9zdGlvbiA9IGlEaXYuc3R5bGUubGVmdCAgO1xuICAgICAgc2VnbWVudEZlZWRiYWNrLndpZHRoID0gd2lkdGg7XG4gICAgICBkZXNjcmlwdGlvbiA9IHRleHRTZWdtZW50LnZhbHVlO1xuICAgICAgZmVlZGJhY2tPblNsaWRlclZpZGVvKHRydWUpO1xuICAgICAgLy92aWRlb0Z1bmN0aW9uYWxDb3JlTWFuYWdlci5leGVjdXRlKG5ldyBSZXBldFBhcnRPZlZpZGVvQ29tbWFuZChzdGFydER1cmF0aW9uLCBlbmREdXJhdGlvbiwgcmVwZXRpdGlvbk51bWJlciwgc3BlZWRSYXRlKSk7XG4gICAgICB2aWRlb0Z1bmN0aW9uYWxDb3JlTWFuYWdlci5leGVjdXRlKG5ldyBSZXBldFBhcnRPZlZpZGVvQ29tbWFuZChzdGFydER1cmF0aW9uLCBlbmREdXJhdGlvbiwgMTAwLCBzcGVlZFJhdGUpKTtcbiAgICB9LCBmYWxzZSk7XG4gICAgLy9UT0RPIHdpZGdldCBjb2xvciBwaWNrZXJcbiAgICAvL2Fycm93RG93bi5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsIHdhdGNoQ29sb3JQaWNrZXIsIGZhbHNlKTtcbiAgfVxuICBmdW5jdGlvbiBpbml0R1VJKCkge1xuICAgIHRleHRTZWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcbiAgICB0ZXh0U2VnbWVudC5jbGFzc05hbWUgPSAndGV4dFNlZ21lbnQnO1xuICAgIC8vVUkgYnV0dG9uIHNwZWVkIGFuZCBzbG93XG4gICAgaW1nUmVwZXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW1nXCIpO1xuICAgIGltZ1JlcGV0LmNsYXNzTmFtZT0naW1nUmVwZXQnO1xuICAgIGltZ1Nsb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW1nXCIpO1xuICBcbiAgICBpbWdTbG93LmNsYXNzTmFtZT0naW1nU2xvdyc7XG4gICAgc2VsZWN0U3BlZWQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic2VsZWN0XCIpO1xuICAgIHNlbGVjdFNwZWVkLmNsYXNzTmFtZSA9J3NlbGVjdFNwZWVkJyA7XG4gICAgc2VsZWN0TmJSZXBldCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzZWxlY3RcIik7XG4gIFxuICAgIHNlbGVjdE5iUmVwZXQuY2xhc3NOYW1lID0nc2VsZWN0TmJSZXBldCcgO1xuICAgIGRpdkluZm9DYXJkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gIFxuICAgIGRpdkluZm9DYXJkLmNsYXNzTmFtZSA9IFwiaW5mb0NhcmRcIjtcbiAgICBcbiAgICAvKnRleHRTZWdtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJmb2N1c1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgICBjYXJkRnVuY3Rpb25hbENvcmUuZXhlY3V0ZShuZXcgTW9kaWZ5Q2FyZERlc2NyaXB0aW9uQ29tbWFuZChjYXJkT2JqZWN0LHRleHRTZWdtZW50LnZhbHVlKSk7XG4gICAgfSk7Ki9cbiAgICB0ZXh0U2VnbWVudC5hZGRFdmVudExpc3RlbmVyKFwiYmx1clwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICBkZXNjcmlwdGlvbiA9IHRleHRTZWdtZW50LnZhbHVlO1xuICAgICAgY2FyZEZ1bmN0aW9uYWxDb3JlLmV4ZWN1dGUobmV3IE1vZGlmeUNhcmREZXNjcmlwdGlvbkNvbW1hbmQoY2FyZE9iamVjdCx0ZXh0U2VnbWVudC52YWx1ZSkpO1xuICAgIH0pO1xuICAgIFxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMjA7IGkgKz0gMSkge1xuICAgICAgc2VsZWN0U3BlZWQuYWRkKG5ldyBPcHRpb24oaSAvIDEwICsgXCJcIikpO1xuICAgIH1cbiAgICBzZWxlY3RTcGVlZC5zZWxlY3RlZEluZGV4ID0gMTA7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCAyMDsgaSsrKSB7XG4gICAgICBzZWxlY3ROYlJlcGV0Lm9wdGlvbnMuYWRkKG5ldyBPcHRpb24oaSArIFwiXCIpKTtcbiAgICB9XG4gIFxuICAgIHNlbGVjdE5iUmVwZXQuc2VsZWN0ZWRJbmRleCA9IDE7XG4gIFxuICAgIC8vRGl2IGNvbnRlbmFudCBsZXMgaW5mbyBkdSBkZXNzdXMgKHRhaWxsZSBkZSBkaXYgaW52YXJpYWJsZSlcbiAgICBkaXZJbmZvQ2FyZC5hcHBlbmRDaGlsZChpbWdTbG93KTtcbiAgICBkaXZJbmZvQ2FyZC5hcHBlbmRDaGlsZChzZWxlY3RTcGVlZCk7XG4gICAgLy9kaXZJbmZvQ2FyZC5hcHBlbmRDaGlsZChpbWdSZXBldCk7XG4gICAgLy9kaXZJbmZvQ2FyZC5hcHBlbmRDaGlsZChzZWxlY3ROYlJlcGV0KTtcbiAgICBkaXZJbmZvQ2FyZC5hcHBlbmRDaGlsZCh0ZXh0U2VnbWVudCk7XG4gICAgLy9kaXZJbmZvQ2FyZC5hcHBlbmRDaGlsZChhcnJvd0Rvd24pO1xuICAgIGlEaXYuYXBwZW5kQ2hpbGQoZGl2U2VnbWVudCk7XG4gICAgaURpdi5hcHBlbmRDaGlsZChkaXZJbmZvQ2FyZCk7XG4gIFxuICBcbiAgICAvL0lmIHRoZSBjYXJkIGhhdmUgYmVlbiBkZWxldGVkLCB0aGUgY29sb3IgaXMgcmVkLCBvdGhlcndpc2UgYmx1ZS5cbiAgICBpZiAoY2FyZEluZm8pIHtcbiAgICAgIGlmKGNhcmRJbmZvLmRlbGV0ZWQpe1xuICAgICAgICBkaXZTZWdtZW50LnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwicmVkXCI7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBkaXZTZWdtZW50LnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwiIzIxM0Y4RFwiO1xuICAgICAgfVxuICAgICAgdGV4dFNlZ21lbnQudmFsdWUgPSBjYXJkSW5mby5kZXNjcmlwdGlvbjtcbiAgICAgIHNlbGVjdE5iUmVwZXQuc2VsZWN0ZWRJbmRleCA9IGNhcmRJbmZvLnJlcGV0aXRpb25OdW1iZXI7XG4gICAgICBzZWxlY3RTcGVlZC5zZWxlY3RlZEluZGV4ID0gY2FyZEluZm8uc3BlZWQqMTA7XG4gICAgfVxuICAgIFxuICB9XG4gIFxuICBcbiAgXG4gIGZ1bmN0aW9uIGluaXRTdHlsZSgpIHtcbiAgICB0ZXh0U2VnbWVudC5zdHlsZS5sZWZ0ID0gZGl2U2VnbWVudC5zdHlsZS53aWR0aDtcbiAgICBpbWdTbG93LnNyYyA9IFwiL21lZGlhL3dvcmtzaG9wMi9jYXJkL3Nsb3cucG5nXCI7XG4gICAgaW1nUmVwZXQuc3JjID0gXCIvbWVkaWEvd29ya3Nob3AyL2NhcmQvcmVwZXQucG5nXCI7XG4gIH1cbiAgXG4gIFxuICBcbiAgZnVuY3Rpb24gY3JlYXRlQnRuRGVsZXRlKGUpe1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAvL2RlbGV0ZSBhcHBhcmFpdFxuICAgIHZhciBidXR0b25EZWxldGUgPSAgZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgYnV0dG9uRGVsZXRlLmlkID0gJ2lkQnRuRGVsZXRlJztcbiAgICBidXR0b25EZWxldGUuc3R5bGUucG9zaXRpb24gPSBcImFic29sdXRlXCI7XG4gICAgYnV0dG9uRGVsZXRlLnR5cGUgPSBcImJ1dHRvblwiO1xuICAgIGJ1dHRvbkRlbGV0ZS5pbm5lckhUTUwgPSBcIkRlbGV0ZVwiO1xuICAgIGJ1dHRvbkRlbGV0ZS5zdHlsZS53aWR0aCA9IFwiMTAwcHhcIjtcbiAgICBkaXZJbmZvQ2FyZC5hcHBlbmRDaGlsZChidXR0b25EZWxldGUpO1xuICAgIGJ1dHRvbkRlbGV0ZS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJyxmdW5jdGlvbihlKXtcbiAgICAgIC8vVE9ET1xuICAgICAgY2FyZE1hbmFnZXIuZXhlY3V0ZShuZXcgRGVsZXRlQ2FyZENvbW1hbmQoY2FyZE9iamVjdCkpO1xuICAgICAgLy9kZWxldGVDYXJkKGNhcmRPYmplY3QpO1xuICAgIH0pO1xuICAgIFxuICAgIGJ1dHRvbkRlbGV0ZS5hZGRFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsZnVuY3Rpb24oZSl7XG4gICAgICBjYXJkTWFuYWdlci5leGVjdXRlKG5ldyBEZWxldGVDYXJkQ29tbWFuZChjYXJkT2JqZWN0KSk7XG4gICAgICAvL2RlbGV0ZUNhcmQoKTtcbiAgICB9KTtcbiAgfVxuICBcbiAgY2FyZE9iamVjdCA9IHtcbiAgICB3aWR0aDogIHdpZHRoLFxuICAgIHN0YXJ0UCA6IHN0YXJ0UCxcbiAgICBlbmRQIDogZW5kUCxcbiAgICBkZXNjcmlwdGlvbiA6IHRoaXMuZGVzY3JpcHRpb24sXG4gICAgc3BlZWQgOiAgdGhpcy5zcGVlZCxcbiAgICByZXBldGl0aW9uTnVtYmVyIDogIHRoaXMucmVwZXRpdGlvbk51bWJlcixcbiAgICBpRGl2OmlEaXYsXG4gICAgaWQ6aURpdi5pZCxcbiAgICB1cGRhdGVJbmZvIDogdXBkYXRlSW5mb1xuICB9O1xuICBcbiAgXG4gIHJldHVybiBjYXJkT2JqZWN0O1xufVxuXG5cblxuIl19