'use strict';

var cardFunctionalCore = new CardFunctionalCore();

function Card(startDurationParam, endDurationParam, startPositionParam, endPositionParam, cardInfo) {
  var description = '';

  //Propriété de style
  var width = '6%';
  var height = '6%';
  var deleted = false;
  var iDiv = null;
  var startP = startPositionParam;
  var endP = endPositionParam;
  //Valeur pour jouer la carte
  var speed = 1;
  var repetitionNumber = 1;
  //div used
  var divInfoCard = null;
  //let selectSpeed=null;
  var selectNbRepet = null;
  var selectSpeed = null;

  var imgSlow = null;

  var textSegment = null;
  var textStartSegment = null;
  var textEndSegment = null;
  var imgRepet = null;
  var divSegment = null;
  var startDuration = startDurationParam;
  var endDuration = endDurationParam;
  var left = void 0;

  var buttonDelete = null;
  var cardObject;

  //cette div est la principale, celle qui contient fragment + bardFragment
  iDiv = document.createElement('div');
  iDiv.id = 'idCard' + createUniqueId();
  iDiv.className = 'segmentWrapper';
  iDiv.style.left = startPositionParam + "px";

  //Color picker
  //var arrowDown = document.createElement('input');
  /* arrowDown.type = 'jscolor';
   arrowDown.className = 'jscolor';
   arrowDown.value = '#8DFFFF';
   //jscolor.installByClassName("jscolor");*/

  /* arrowDown.border = 'none';
   arrowDown.outline = 'none';
   arrowDown.style.backgroundColor = 'black';
   arrowDown.style.webkitAppearance = 'listitem';
   arrowDown.value = "#41568d";*/

  //arrowDown.value = "FF9900";
  //arrowDown.mode = 'HS';
  //arrowDown.position = 'right' ;
  /* arrowDown.value ="#102b9f";
   arrowDown.style.outline="none";*/

  //Div du segment bleu
  divSegment = document.createElement('div');
  divSegment.className = 'segment';

  //taille de la carte initiale
  width = iDiv.style.width = parseInt(endPositionParam, 10) - parseInt(startPositionParam, 10) + "px";
  divSegment.style.width = parseInt(endPositionParam, 10) - parseInt(startPositionParam, 10) + "px";

  initGUI();
  initStyle();
  initListener();
  playCard(iDiv, startDurationParam);

  function watchColorPicker(event) {
    divSegment.style.backgroundColor = event.target.value;
    console.log("color");
  }
  //console.log(cardInfo.deleted);
  function updateInfo() {
    //    console.log(description,speed,repetitionNumber);
    cardObject.width = width;
    cardObject.startP = startP;
    cardObject.endP = endP;
    cardObject.description = description;
    cardObject.speed = speed;
    cardObject.deleted = deleted;
    cardObject.repetitionNumber = repetitionNumber;
    cardObject.iDiv = iDiv;
    cardObject.id = iDiv.id;
    return cardObject;
  }

  function initListener() {
    textSegment.addEventListener('long-press', function (e) {
      createBtnDelete(e);
    });
    divSegment.addEventListener('long-press', function (e) {
      createBtnDelete(e);
    });
    selectSpeed.addEventListener("blur", function (e) {
      var speedRate = selectSpeed.options[selectSpeed.selectedIndex].value;
      speed = speedRate;
      cardFunctionalCore.execute(new CardSpeedCommand(cardObject, speedRate));
    });
    selectNbRepet.addEventListener("blur", function (e) {
      repetitionNumber = selectNbRepet.options[selectNbRepet.selectedIndex].value;
      console.log("nbrepet in card :" + repetitionNumber);
      cardFunctionalCore.execute(new CardNbRepetCommand(cardObject, repetitionNumber));
      //cardFunctionalCore.execute(new CardNbRepetCommand(cardObject, 100));
    });
    divSegment.addEventListener("mousedown", function (e) {
      repetitionNumber = selectNbRepet.options[selectNbRepet.selectedIndex].value;
      var speedRate = selectSpeed.options[selectSpeed.selectedIndex].value;
      speed = speedRate;
      segmentFeedback.startPostion = iDiv.style.left;
      segmentFeedback.width = width;
      description = textSegment.value;
      feedbackOnSliderVideo(true);
      //videoFunctionalCoreManager.execute(new RepetPartOfVideoCommand(startDuration, endDuration, repetitionNumber, speedRate));
      videoFunctionalCoreManager.execute(new RepetPartOfVideoCommand(startDuration, endDuration, 100, speedRate));
    }, false);
    //TODO widget color picker
    //arrowDown.addEventListener("change", watchColorPicker, false);
  }
  function initGUI() {
    textSegment = document.createElement('input');
    textSegment.className = 'textSegment';
    //UI button speed and slow
    imgRepet = document.createElement("img");
    imgRepet.className = 'imgRepet';
    imgSlow = document.createElement("img");

    imgSlow.className = 'imgSlow';
    selectSpeed = document.createElement("select");
    selectSpeed.className = 'selectSpeed';
    selectNbRepet = document.createElement("select");

    selectNbRepet.className = 'selectNbRepet';
    divInfoCard = document.createElement('div');

    divInfoCard.className = "infoCard";

    /*textSegment.addEventListener("focus", function () {
      cardFunctionalCore.execute(new ModifyCardDescriptionCommand(cardObject,textSegment.value));
    });*/
    textSegment.addEventListener("blur", function () {
      description = textSegment.value;
      cardFunctionalCore.execute(new ModifyCardDescriptionCommand(cardObject, textSegment.value));
    });

    for (var i = 0; i < 20; i += 1) {
      selectSpeed.add(new Option(i / 10 + ""));
    }
    selectSpeed.selectedIndex = 10;
    for (var _i = 0; _i < 20; _i++) {
      selectNbRepet.options.add(new Option(_i + ""));
    }

    selectNbRepet.selectedIndex = 1;
    /*
    Creation des étapes pour facilement changer la taille des segments
    
      textStartSegment = document.createElement('input');
      textStartSegment.className = '';
      textEndSegment = document.createElement('input');
      textEndSegment.className = '';
      divInfoCard.appendChild(textStartSegment);
      divInfoCard.appendChild(textEndSegment);
    */

    //Div contenant les info du dessus (taille de div invariable)
    divInfoCard.appendChild(imgSlow);
    divInfoCard.appendChild(selectSpeed);
    //divInfoCard.appendChild(imgRepet);
    //divInfoCard.appendChild(selectNbRepet);
    divInfoCard.appendChild(textSegment);
    //divInfoCard.appendChild(arrowDown);
    iDiv.appendChild(divSegment);
    iDiv.appendChild(divInfoCard);

    //If the card have been deleted, the color is red, otherwise blue.
    if (cardInfo) {
      if (cardInfo.deleted) {
        divSegment.style.backgroundColor = "red";
      } else {
        divSegment.style.backgroundColor = "#213F8D";
      }
      textSegment.value = cardInfo.description;
      selectNbRepet.selectedIndex = cardInfo.repetitionNumber;
      selectSpeed.selectedIndex = cardInfo.speed * 10;
    }
  }

  function initStyle() {
    textSegment.style.left = divSegment.style.width;
    imgSlow.src = "/media/workshop2/card/slow.png";
    imgRepet.src = "/media/workshop2/card/repet.png";
  }

  function createBtnDelete(e) {
    e.preventDefault();
    //delete apparait
    var buttonDelete = document.createElement('button');
    buttonDelete.id = 'idBtnDelete';
    buttonDelete.style.position = "absolute";
    buttonDelete.type = "button";
    buttonDelete.innerHTML = "Delete";
    buttonDelete.style.width = "100px";
    divInfoCard.appendChild(buttonDelete);
    buttonDelete.addEventListener('mouseup', function (e) {
      //TODO
      cardManager.execute(new DeleteCardCommand(cardObject));
      //deleteCard(cardObject);
    });

    buttonDelete.addEventListener('touchend', function (e) {
      cardManager.execute(new DeleteCardCommand(cardObject));
      //deleteCard();
    });
  }

  cardObject = {
    width: width,
    startP: startP,
    endP: endP,
    description: this.description,
    speed: this.speed,
    repetitionNumber: this.repetitionNumber,
    iDiv: iDiv,
    id: iDiv.id,
    updateInfo: updateInfo
  };

  return cardObject;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNhcmQuanMiXSwibmFtZXMiOlsiY2FyZEZ1bmN0aW9uYWxDb3JlIiwiQ2FyZEZ1bmN0aW9uYWxDb3JlIiwiQ2FyZCIsInN0YXJ0RHVyYXRpb25QYXJhbSIsImVuZER1cmF0aW9uUGFyYW0iLCJzdGFydFBvc2l0aW9uUGFyYW0iLCJlbmRQb3NpdGlvblBhcmFtIiwiY2FyZEluZm8iLCJkZXNjcmlwdGlvbiIsIndpZHRoIiwiaGVpZ2h0IiwiZGVsZXRlZCIsImlEaXYiLCJzdGFydFAiLCJlbmRQIiwic3BlZWQiLCJyZXBldGl0aW9uTnVtYmVyIiwiZGl2SW5mb0NhcmQiLCJzZWxlY3ROYlJlcGV0Iiwic2VsZWN0U3BlZWQiLCJpbWdTbG93IiwidGV4dFNlZ21lbnQiLCJ0ZXh0U3RhcnRTZWdtZW50IiwidGV4dEVuZFNlZ21lbnQiLCJpbWdSZXBldCIsImRpdlNlZ21lbnQiLCJzdGFydER1cmF0aW9uIiwiZW5kRHVyYXRpb24iLCJsZWZ0IiwiYnV0dG9uRGVsZXRlIiwiY2FyZE9iamVjdCIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImlkIiwiY3JlYXRlVW5pcXVlSWQiLCJjbGFzc05hbWUiLCJzdHlsZSIsInBhcnNlSW50IiwiaW5pdEdVSSIsImluaXRTdHlsZSIsImluaXRMaXN0ZW5lciIsInBsYXlDYXJkIiwid2F0Y2hDb2xvclBpY2tlciIsImV2ZW50IiwiYmFja2dyb3VuZENvbG9yIiwidGFyZ2V0IiwidmFsdWUiLCJjb25zb2xlIiwibG9nIiwidXBkYXRlSW5mbyIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwiY3JlYXRlQnRuRGVsZXRlIiwic3BlZWRSYXRlIiwib3B0aW9ucyIsInNlbGVjdGVkSW5kZXgiLCJleGVjdXRlIiwiQ2FyZFNwZWVkQ29tbWFuZCIsIkNhcmROYlJlcGV0Q29tbWFuZCIsInNlZ21lbnRGZWVkYmFjayIsInN0YXJ0UG9zdGlvbiIsImZlZWRiYWNrT25TbGlkZXJWaWRlbyIsInZpZGVvRnVuY3Rpb25hbENvcmVNYW5hZ2VyIiwiUmVwZXRQYXJ0T2ZWaWRlb0NvbW1hbmQiLCJNb2RpZnlDYXJkRGVzY3JpcHRpb25Db21tYW5kIiwiaSIsImFkZCIsIk9wdGlvbiIsImFwcGVuZENoaWxkIiwic3JjIiwicHJldmVudERlZmF1bHQiLCJwb3NpdGlvbiIsInR5cGUiLCJpbm5lckhUTUwiLCJjYXJkTWFuYWdlciIsIkRlbGV0ZUNhcmRDb21tYW5kIl0sIm1hcHBpbmdzIjoiOztBQUFBLElBQUlBLHFCQUFxQixJQUFJQyxrQkFBSixFQUF6Qjs7QUFFQSxTQUFTQyxJQUFULENBQWVDLGtCQUFmLEVBQWtDQyxnQkFBbEMsRUFBbURDLGtCQUFuRCxFQUFzRUMsZ0JBQXRFLEVBQXdGQyxRQUF4RixFQUFrRztBQUNoRyxNQUFJQyxjQUFjLEVBQWxCOztBQUVBO0FBQ0EsTUFBSUMsUUFBUSxJQUFaO0FBQ0EsTUFBSUMsU0FBUyxJQUFiO0FBQ0EsTUFBSUMsVUFBVSxLQUFkO0FBQ0EsTUFBSUMsT0FBTyxJQUFYO0FBQ0EsTUFBSUMsU0FBU1Isa0JBQWI7QUFDQSxNQUFJUyxPQUFPUixnQkFBWDtBQUNGO0FBQ0UsTUFBSVMsUUFBUSxDQUFaO0FBQ0EsTUFBSUMsbUJBQW1CLENBQXZCO0FBQ0Y7QUFDRSxNQUFJQyxjQUFjLElBQWxCO0FBQ0E7QUFDQSxNQUFJQyxnQkFBZ0IsSUFBcEI7QUFDQSxNQUFJQyxjQUFjLElBQWxCOztBQUVBLE1BQUlDLFVBQVUsSUFBZDs7QUFJQSxNQUFJQyxjQUFjLElBQWxCO0FBQ0EsTUFBSUMsbUJBQW1CLElBQXZCO0FBQ0EsTUFBSUMsaUJBQWlCLElBQXJCO0FBQ0EsTUFBSUMsV0FBVyxJQUFmO0FBQ0EsTUFBSUMsYUFBYSxJQUFqQjtBQUNBLE1BQUlDLGdCQUFnQnZCLGtCQUFwQjtBQUNBLE1BQUl3QixjQUFjdkIsZ0JBQWxCO0FBQ0EsTUFBSXdCLGFBQUo7O0FBRUEsTUFBSUMsZUFBZSxJQUFuQjtBQUNBLE1BQUlDLFVBQUo7O0FBRUE7QUFDQWxCLFNBQU9tQixTQUFTQyxhQUFULENBQXVCLEtBQXZCLENBQVA7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LEtBQUtBLGdCQU5kO0FBT1hKLFVBQUtBLElBUE07QUFRWHFCLFFBQUdyQixLQUFLcUIsRUFSRztBQVNYZ0IsZ0JBQWFBO0FBVEYsR0FBYjs7QUFhQSxTQUFPbkIsVUFBUDtBQUNEIiwiZmlsZSI6ImNhcmQuanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgY2FyZEZ1bmN0aW9uYWxDb3JlID0gbmV3IENhcmRGdW5jdGlvbmFsQ29yZSgpO1xuXG5mdW5jdGlvbiBDYXJkIChzdGFydER1cmF0aW9uUGFyYW0sZW5kRHVyYXRpb25QYXJhbSxzdGFydFBvc2l0aW9uUGFyYW0sZW5kUG9zaXRpb25QYXJhbSwgY2FyZEluZm8pIHtcbiAgdmFyIGRlc2NyaXB0aW9uID0gJyc7XG4gIFxuICAvL1Byb3ByacOpdMOpIGRlIHN0eWxlXG4gIGxldCB3aWR0aCA9ICc2JSc7XG4gIGxldCBoZWlnaHQgPSAnNiUnO1xuICB2YXIgZGVsZXRlZCA9IGZhbHNlO1xuICB2YXIgaURpdiA9IG51bGw7XG4gIHZhciBzdGFydFAgPSBzdGFydFBvc2l0aW9uUGFyYW07XG4gIHZhciBlbmRQID0gZW5kUG9zaXRpb25QYXJhbTtcbi8vVmFsZXVyIHBvdXIgam91ZXIgbGEgY2FydGVcbiAgdmFyIHNwZWVkID0gMTtcbiAgdmFyIHJlcGV0aXRpb25OdW1iZXIgPSAxO1xuLy9kaXYgdXNlZFxuICBsZXQgZGl2SW5mb0NhcmQgPSBudWxsO1xuICAvL2xldCBzZWxlY3RTcGVlZD1udWxsO1xuICBsZXQgc2VsZWN0TmJSZXBldCA9IG51bGw7XG4gIGxldCBzZWxlY3RTcGVlZCA9IG51bGw7XG4gIFxuICBsZXQgaW1nU2xvdyA9IG51bGw7XG4gIFxuICBcbiAgXG4gIHZhciB0ZXh0U2VnbWVudCA9IG51bGw7XG4gIHZhciB0ZXh0U3RhcnRTZWdtZW50ID0gbnVsbDtcbiAgdmFyIHRleHRFbmRTZWdtZW50ID0gbnVsbDtcbiAgbGV0IGltZ1JlcGV0ID0gbnVsbDtcbiAgbGV0IGRpdlNlZ21lbnQgPSBudWxsO1xuICBsZXQgc3RhcnREdXJhdGlvbiA9IHN0YXJ0RHVyYXRpb25QYXJhbTtcbiAgbGV0IGVuZER1cmF0aW9uID0gZW5kRHVyYXRpb25QYXJhbTtcbiAgbGV0IGxlZnQgO1xuICBcbiAgdmFyIGJ1dHRvbkRlbGV0ZSA9IG51bGw7XG4gIHZhciBjYXJkT2JqZWN0O1xuICBcbiAgLy9jZXR0ZSBkaXYgZXN0IGxhIHByaW5jaXBhbGUsIGNlbGxlIHF1aSBjb250aWVudCBmcmFnbWVudCArIGJhcmRGcmFnbWVudFxuICBpRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gIGlEaXYuaWQgPSAnaWRDYXJkJyArIGNyZWF0ZVVuaXF1ZUlkKCk7XG4gIGlEaXYuY2xhc3NOYW1lID0gJ3NlZ21lbnRXcmFwcGVyJztcbiAgaURpdi5zdHlsZS5sZWZ0ID0gc3RhcnRQb3NpdGlvblBhcmFtICsgXCJweFwiO1xuICBcbiAgXG4gIC8vQ29sb3IgcGlja2VyXG4gIC8vdmFyIGFycm93RG93biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XG4gLyogYXJyb3dEb3duLnR5cGUgPSAnanNjb2xvcic7XG4gIGFycm93RG93bi5jbGFzc05hbWUgPSAnanNjb2xvcic7XG4gIGFycm93RG93bi52YWx1ZSA9ICcjOERGRkZGJztcbiAgLy9qc2NvbG9yLmluc3RhbGxCeUNsYXNzTmFtZShcImpzY29sb3JcIik7Ki9cbiAgXG4gIFxuICBcbiAgLyogYXJyb3dEb3duLmJvcmRlciA9ICdub25lJztcbiAgIGFycm93RG93bi5vdXRsaW5lID0gJ25vbmUnO1xuICAgYXJyb3dEb3duLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICdibGFjayc7XG4gICBhcnJvd0Rvd24uc3R5bGUud2Via2l0QXBwZWFyYW5jZSA9ICdsaXN0aXRlbSc7XG4gICBhcnJvd0Rvd24udmFsdWUgPSBcIiM0MTU2OGRcIjsqL1xuICBcbiAgICAgLy9hcnJvd0Rvd24udmFsdWUgPSBcIkZGOTkwMFwiO1xuICAvL2Fycm93RG93bi5tb2RlID0gJ0hTJztcbiAgLy9hcnJvd0Rvd24ucG9zaXRpb24gPSAncmlnaHQnIDtcbiAvKiBhcnJvd0Rvd24udmFsdWUgPVwiIzEwMmI5ZlwiO1xuICBhcnJvd0Rvd24uc3R5bGUub3V0bGluZT1cIm5vbmVcIjsqL1xuICBcbiAgLy9EaXYgZHUgc2VnbWVudCBibGV1XG4gIGRpdlNlZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgZGl2U2VnbWVudC5jbGFzc05hbWUgPSAnc2VnbWVudCc7XG4gIFxuICAvL3RhaWxsZSBkZSBsYSBjYXJ0ZSBpbml0aWFsZVxuICB3aWR0aCA9IGlEaXYuc3R5bGUud2lkdGggPSBwYXJzZUludChlbmRQb3NpdGlvblBhcmFtLCAxMCkgLSBwYXJzZUludChzdGFydFBvc2l0aW9uUGFyYW0sIDEwKSArIFwicHhcIjtcbiAgZGl2U2VnbWVudC5zdHlsZS53aWR0aCA9IHBhcnNlSW50KGVuZFBvc2l0aW9uUGFyYW0sIDEwKSAtIHBhcnNlSW50KHN0YXJ0UG9zaXRpb25QYXJhbSwgMTApICsgXCJweFwiO1xuICBcbiAgaW5pdEdVSSgpO1xuICBpbml0U3R5bGUoKTtcbiAgaW5pdExpc3RlbmVyKCk7XG4gIHBsYXlDYXJkKGlEaXYsIHN0YXJ0RHVyYXRpb25QYXJhbSk7XG4gIFxuICBcbiAgZnVuY3Rpb24gd2F0Y2hDb2xvclBpY2tlcihldmVudCkge1xuICAgIGRpdlNlZ21lbnQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gZXZlbnQudGFyZ2V0LnZhbHVlO1xuICAgIGNvbnNvbGUubG9nKFwiY29sb3JcIik7XG4gIH1cbiAgLy9jb25zb2xlLmxvZyhjYXJkSW5mby5kZWxldGVkKTtcbiAgZnVuY3Rpb24gdXBkYXRlSW5mbygpe1xuLy8gICAgY29uc29sZS5sb2coZGVzY3JpcHRpb24sc3BlZWQscmVwZXRpdGlvbk51bWJlcik7XG4gICAgY2FyZE9iamVjdC53aWR0aCA9IHdpZHRoO1xuICAgIGNhcmRPYmplY3Quc3RhcnRQID0gc3RhcnRQO1xuICAgIGNhcmRPYmplY3QuZW5kUCA9IGVuZFA7XG4gICAgY2FyZE9iamVjdC5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uO1xuICAgIGNhcmRPYmplY3Quc3BlZWQgPSBzcGVlZDtcbiAgICBjYXJkT2JqZWN0LmRlbGV0ZWQgPSBkZWxldGVkO1xuICAgIGNhcmRPYmplY3QucmVwZXRpdGlvbk51bWJlciA9IHJlcGV0aXRpb25OdW1iZXI7XG4gICAgY2FyZE9iamVjdC5pRGl2ID0gaURpdjtcbiAgICBjYXJkT2JqZWN0LmlkID0gaURpdi5pZDtcbiAgICByZXR1cm4gY2FyZE9iamVjdDtcbiAgfVxuICBcbiAgXG4gIGZ1bmN0aW9uIGluaXRMaXN0ZW5lcigpIHtcbiAgICB0ZXh0U2VnbWVudC5hZGRFdmVudExpc3RlbmVyKCdsb25nLXByZXNzJywgZnVuY3Rpb24oZSl7XG4gICAgICBjcmVhdGVCdG5EZWxldGUoZSk7XG4gICAgfSk7XG4gICAgZGl2U2VnbWVudC5hZGRFdmVudExpc3RlbmVyKCdsb25nLXByZXNzJywgZnVuY3Rpb24oZSl7XG4gICAgICBjcmVhdGVCdG5EZWxldGUoZSk7XG4gICAgfSk7XG4gICAgc2VsZWN0U3BlZWQuYWRkRXZlbnRMaXN0ZW5lcihcImJsdXJcIiwgZnVuY3Rpb24oZSl7XG4gICAgICBsZXQgc3BlZWRSYXRlID0gc2VsZWN0U3BlZWQub3B0aW9uc1tzZWxlY3RTcGVlZC5zZWxlY3RlZEluZGV4XS52YWx1ZTtcbiAgICAgIHNwZWVkID0gc3BlZWRSYXRlO1xuICAgICAgY2FyZEZ1bmN0aW9uYWxDb3JlLmV4ZWN1dGUobmV3IENhcmRTcGVlZENvbW1hbmQoY2FyZE9iamVjdCxzcGVlZFJhdGUpKTtcbiAgICB9KTtcbiAgICBzZWxlY3ROYlJlcGV0LmFkZEV2ZW50TGlzdGVuZXIoXCJibHVyXCIsIGZ1bmN0aW9uKGUpe1xuICAgICAgcmVwZXRpdGlvbk51bWJlciA9IHNlbGVjdE5iUmVwZXQub3B0aW9uc1tzZWxlY3ROYlJlcGV0LnNlbGVjdGVkSW5kZXhdLnZhbHVlO1xuICAgICAgY29uc29sZS5sb2coXCJuYnJlcGV0IGluIGNhcmQgOlwiICsgIHJlcGV0aXRpb25OdW1iZXIpO1xuICAgICAgY2FyZEZ1bmN0aW9uYWxDb3JlLmV4ZWN1dGUobmV3IENhcmROYlJlcGV0Q29tbWFuZChjYXJkT2JqZWN0LCByZXBldGl0aW9uTnVtYmVyKSk7XG4gICAgICAvL2NhcmRGdW5jdGlvbmFsQ29yZS5leGVjdXRlKG5ldyBDYXJkTmJSZXBldENvbW1hbmQoY2FyZE9iamVjdCwgMTAwKSk7XG4gICAgfSk7XG4gICAgZGl2U2VnbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIGZ1bmN0aW9uIChlKSB7XG4gICAgICByZXBldGl0aW9uTnVtYmVyID0gc2VsZWN0TmJSZXBldC5vcHRpb25zW3NlbGVjdE5iUmVwZXQuc2VsZWN0ZWRJbmRleF0udmFsdWU7XG4gICAgICBsZXQgc3BlZWRSYXRlID0gc2VsZWN0U3BlZWQub3B0aW9uc1tzZWxlY3RTcGVlZC5zZWxlY3RlZEluZGV4XS52YWx1ZTtcbiAgICAgIHNwZWVkID0gc3BlZWRSYXRlO1xuICAgICAgc2VnbWVudEZlZWRiYWNrLnN0YXJ0UG9zdGlvbiA9IGlEaXYuc3R5bGUubGVmdCAgO1xuICAgICAgc2VnbWVudEZlZWRiYWNrLndpZHRoID0gd2lkdGg7XG4gICAgICBkZXNjcmlwdGlvbiA9IHRleHRTZWdtZW50LnZhbHVlO1xuICAgICAgZmVlZGJhY2tPblNsaWRlclZpZGVvKHRydWUpO1xuICAgICAgLy92aWRlb0Z1bmN0aW9uYWxDb3JlTWFuYWdlci5leGVjdXRlKG5ldyBSZXBldFBhcnRPZlZpZGVvQ29tbWFuZChzdGFydER1cmF0aW9uLCBlbmREdXJhdGlvbiwgcmVwZXRpdGlvbk51bWJlciwgc3BlZWRSYXRlKSk7XG4gICAgICB2aWRlb0Z1bmN0aW9uYWxDb3JlTWFuYWdlci5leGVjdXRlKG5ldyBSZXBldFBhcnRPZlZpZGVvQ29tbWFuZChzdGFydER1cmF0aW9uLCBlbmREdXJhdGlvbiwgMTAwLCBzcGVlZFJhdGUpKTtcbiAgICB9LCBmYWxzZSk7XG4gICAgLy9UT0RPIHdpZGdldCBjb2xvciBwaWNrZXJcbiAgICAvL2Fycm93RG93bi5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsIHdhdGNoQ29sb3JQaWNrZXIsIGZhbHNlKTtcbiAgfVxuICBmdW5jdGlvbiBpbml0R1VJKCkge1xuICAgIHRleHRTZWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcbiAgICB0ZXh0U2VnbWVudC5jbGFzc05hbWUgPSAndGV4dFNlZ21lbnQnO1xuICAgIC8vVUkgYnV0dG9uIHNwZWVkIGFuZCBzbG93XG4gICAgaW1nUmVwZXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW1nXCIpO1xuICAgIGltZ1JlcGV0LmNsYXNzTmFtZT0naW1nUmVwZXQnO1xuICAgIGltZ1Nsb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW1nXCIpO1xuICBcbiAgICBpbWdTbG93LmNsYXNzTmFtZT0naW1nU2xvdyc7XG4gICAgc2VsZWN0U3BlZWQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic2VsZWN0XCIpO1xuICAgIHNlbGVjdFNwZWVkLmNsYXNzTmFtZSA9J3NlbGVjdFNwZWVkJyA7XG4gICAgc2VsZWN0TmJSZXBldCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzZWxlY3RcIik7XG4gIFxuICAgIHNlbGVjdE5iUmVwZXQuY2xhc3NOYW1lID0nc2VsZWN0TmJSZXBldCcgO1xuICAgIGRpdkluZm9DYXJkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gIFxuICAgIGRpdkluZm9DYXJkLmNsYXNzTmFtZSA9IFwiaW5mb0NhcmRcIjtcbiAgICBcbiAgICAvKnRleHRTZWdtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJmb2N1c1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgICBjYXJkRnVuY3Rpb25hbENvcmUuZXhlY3V0ZShuZXcgTW9kaWZ5Q2FyZERlc2NyaXB0aW9uQ29tbWFuZChjYXJkT2JqZWN0LHRleHRTZWdtZW50LnZhbHVlKSk7XG4gICAgfSk7Ki9cbiAgICB0ZXh0U2VnbWVudC5hZGRFdmVudExpc3RlbmVyKFwiYmx1clwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICBkZXNjcmlwdGlvbiA9IHRleHRTZWdtZW50LnZhbHVlO1xuICAgICAgY2FyZEZ1bmN0aW9uYWxDb3JlLmV4ZWN1dGUobmV3IE1vZGlmeUNhcmREZXNjcmlwdGlvbkNvbW1hbmQoY2FyZE9iamVjdCx0ZXh0U2VnbWVudC52YWx1ZSkpO1xuICAgIH0pO1xuICAgIFxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMjA7IGkgKz0gMSkge1xuICAgICAgc2VsZWN0U3BlZWQuYWRkKG5ldyBPcHRpb24oaSAvIDEwICsgXCJcIikpO1xuICAgIH1cbiAgICBzZWxlY3RTcGVlZC5zZWxlY3RlZEluZGV4ID0gMTA7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCAyMDsgaSsrKSB7XG4gICAgICBzZWxlY3ROYlJlcGV0Lm9wdGlvbnMuYWRkKG5ldyBPcHRpb24oaSArIFwiXCIpKTtcbiAgICB9XG4gIFxuICAgIHNlbGVjdE5iUmVwZXQuc2VsZWN0ZWRJbmRleCA9IDE7XG4gIC8qXG4gIENyZWF0aW9uIGRlcyDDqXRhcGVzIHBvdXIgZmFjaWxlbWVudCBjaGFuZ2VyIGxhIHRhaWxsZSBkZXMgc2VnbWVudHNcbiAgXG4gICAgdGV4dFN0YXJ0U2VnbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XG4gICAgdGV4dFN0YXJ0U2VnbWVudC5jbGFzc05hbWUgPSAnJztcbiAgICB0ZXh0RW5kU2VnbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XG4gICAgdGV4dEVuZFNlZ21lbnQuY2xhc3NOYW1lID0gJyc7XG4gICAgZGl2SW5mb0NhcmQuYXBwZW5kQ2hpbGQodGV4dFN0YXJ0U2VnbWVudCk7XG4gICAgZGl2SW5mb0NhcmQuYXBwZW5kQ2hpbGQodGV4dEVuZFNlZ21lbnQpO1xuICAqL1xuICBcbiAgICAvL0RpdiBjb250ZW5hbnQgbGVzIGluZm8gZHUgZGVzc3VzICh0YWlsbGUgZGUgZGl2IGludmFyaWFibGUpXG4gICAgZGl2SW5mb0NhcmQuYXBwZW5kQ2hpbGQoaW1nU2xvdyk7XG4gICAgZGl2SW5mb0NhcmQuYXBwZW5kQ2hpbGQoc2VsZWN0U3BlZWQpO1xuICAgIC8vZGl2SW5mb0NhcmQuYXBwZW5kQ2hpbGQoaW1nUmVwZXQpO1xuICAgIC8vZGl2SW5mb0NhcmQuYXBwZW5kQ2hpbGQoc2VsZWN0TmJSZXBldCk7XG4gICAgZGl2SW5mb0NhcmQuYXBwZW5kQ2hpbGQodGV4dFNlZ21lbnQpO1xuICAgIC8vZGl2SW5mb0NhcmQuYXBwZW5kQ2hpbGQoYXJyb3dEb3duKTtcbiAgICBpRGl2LmFwcGVuZENoaWxkKGRpdlNlZ21lbnQpO1xuICAgIGlEaXYuYXBwZW5kQ2hpbGQoZGl2SW5mb0NhcmQpO1xuICBcbiAgICBcbiAgXG4gIFxuICAgIC8vSWYgdGhlIGNhcmQgaGF2ZSBiZWVuIGRlbGV0ZWQsIHRoZSBjb2xvciBpcyByZWQsIG90aGVyd2lzZSBibHVlLlxuICAgIGlmIChjYXJkSW5mbykge1xuICAgICAgaWYoY2FyZEluZm8uZGVsZXRlZCl7XG4gICAgICAgIGRpdlNlZ21lbnQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCJyZWRcIjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGRpdlNlZ21lbnQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCIjMjEzRjhEXCI7XG4gICAgICB9XG4gICAgICB0ZXh0U2VnbWVudC52YWx1ZSA9IGNhcmRJbmZvLmRlc2NyaXB0aW9uO1xuICAgICAgc2VsZWN0TmJSZXBldC5zZWxlY3RlZEluZGV4ID0gY2FyZEluZm8ucmVwZXRpdGlvbk51bWJlcjtcbiAgICAgIHNlbGVjdFNwZWVkLnNlbGVjdGVkSW5kZXggPSBjYXJkSW5mby5zcGVlZCoxMDtcbiAgICB9XG4gIH1cbiAgXG4gIFxuICBcbiAgZnVuY3Rpb24gaW5pdFN0eWxlKCkge1xuICAgIHRleHRTZWdtZW50LnN0eWxlLmxlZnQgPSBkaXZTZWdtZW50LnN0eWxlLndpZHRoO1xuICAgIGltZ1Nsb3cuc3JjID0gXCIvbWVkaWEvd29ya3Nob3AyL2NhcmQvc2xvdy5wbmdcIjtcbiAgICBpbWdSZXBldC5zcmMgPSBcIi9tZWRpYS93b3Jrc2hvcDIvY2FyZC9yZXBldC5wbmdcIjtcbiAgfVxuICBcbiAgXG4gIFxuICBmdW5jdGlvbiBjcmVhdGVCdG5EZWxldGUoZSl7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIC8vZGVsZXRlIGFwcGFyYWl0XG4gICAgdmFyIGJ1dHRvbkRlbGV0ZSA9ICBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcbiAgICBidXR0b25EZWxldGUuaWQgPSAnaWRCdG5EZWxldGUnO1xuICAgIGJ1dHRvbkRlbGV0ZS5zdHlsZS5wb3NpdGlvbiA9IFwiYWJzb2x1dGVcIjtcbiAgICBidXR0b25EZWxldGUudHlwZSA9IFwiYnV0dG9uXCI7XG4gICAgYnV0dG9uRGVsZXRlLmlubmVySFRNTCA9IFwiRGVsZXRlXCI7XG4gICAgYnV0dG9uRGVsZXRlLnN0eWxlLndpZHRoID0gXCIxMDBweFwiO1xuICAgIGRpdkluZm9DYXJkLmFwcGVuZENoaWxkKGJ1dHRvbkRlbGV0ZSk7XG4gICAgYnV0dG9uRGVsZXRlLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLGZ1bmN0aW9uKGUpe1xuICAgICAgLy9UT0RPXG4gICAgICBjYXJkTWFuYWdlci5leGVjdXRlKG5ldyBEZWxldGVDYXJkQ29tbWFuZChjYXJkT2JqZWN0KSk7XG4gICAgICAvL2RlbGV0ZUNhcmQoY2FyZE9iamVjdCk7XG4gICAgfSk7XG4gICAgXG4gICAgYnV0dG9uRGVsZXRlLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJyxmdW5jdGlvbihlKXtcbiAgICAgIGNhcmRNYW5hZ2VyLmV4ZWN1dGUobmV3IERlbGV0ZUNhcmRDb21tYW5kKGNhcmRPYmplY3QpKTtcbiAgICAgIC8vZGVsZXRlQ2FyZCgpO1xuICAgIH0pO1xuICB9XG4gIFxuICBjYXJkT2JqZWN0ID0ge1xuICAgIHdpZHRoOiAgd2lkdGgsXG4gICAgc3RhcnRQIDogc3RhcnRQLFxuICAgIGVuZFAgOiBlbmRQLFxuICAgIGRlc2NyaXB0aW9uIDogdGhpcy5kZXNjcmlwdGlvbixcbiAgICBzcGVlZCA6ICB0aGlzLnNwZWVkLFxuICAgIHJlcGV0aXRpb25OdW1iZXIgOiAgdGhpcy5yZXBldGl0aW9uTnVtYmVyLFxuICAgIGlEaXY6aURpdixcbiAgICBpZDppRGl2LmlkLFxuICAgIHVwZGF0ZUluZm8gOiB1cGRhdGVJbmZvXG4gIH07XG4gIFxuICBcbiAgcmV0dXJuIGNhcmRPYmplY3Q7XG59XG5cblxuXG4iXX0=