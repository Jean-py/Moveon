'use strict';

var cardFunctionalCore = new CardFunctionalCore();

function Card(startDurationParam, endDurationParam, startPositionParam, endPositionParam, cardInfo) {
  var description = '';

  //Propriété de style
  var width = '6%';
  var height = '6%';
  var deleted = false;
  var iDiv = null;
  var startP = startPositionParam;
  var endP = endPositionParam;
  //Valeur pour jouer la carte
  var speed = 1;
  var repetitionNumber = 1;
  //div used
  var divInfoCard = null;
  //let selectSpeed=null;
  var selectNbRepet = null;
  var selectSpeed = null;

  var imgSlow = null;

  var textSegment = null;
  var imgRepet = null;
  var divSegment = null;
  var startDuration = startDurationParam;
  var endDuration = endDurationParam;
  var left = void 0;

  var buttonDelete = null;
  var cardObject;

  //cette div est la principale, celle qui contient fragment + bardFragment
  iDiv = document.createElement('div');
  iDiv.id = 'idCard' + createUniqueId();
  iDiv.className = 'segmentWrapper';
  iDiv.style.left = startPositionParam + "px";

  //Color picker
  var arrowDown = document.createElement('input');
  arrowDown.type = 'jscolor';
  arrowDown.className = 'jscolor';
  arrowDown.value = '#8DFFFF';
  jscolor.installByClassName("jscolor");

  /* arrowDown.border = 'none';
   arrowDown.outline = 'none';
   arrowDown.style.backgroundColor = 'black';
   arrowDown.style.webkitAppearance = 'listitem';
   arrowDown.value = "#41568d";*/

  //arrowDown.value = "FF9900";
  //arrowDown.mode = 'HS';
  //arrowDown.position = 'right' ;
  /* arrowDown.value ="#102b9f";
   arrowDown.style.outline="none";*/

  //Div du segment bleu
  divSegment = document.createElement('div');
  divSegment.className = 'segment';

  //taille de la carte initiale
  width = iDiv.style.width = parseInt(endPositionParam, 10) - parseInt(startPositionParam, 10) + "px";
  divSegment.style.width = parseInt(endPositionParam, 10) - parseInt(startPositionParam, 10) + "px";

  initGUI();
  initStyle();
  initListener();
  playCard(iDiv, startDurationParam);

  function watchColorPicker(event) {
    divSegment.style.backgroundColor = event.target.value;
    console.log("color");
  }
  //console.log(cardInfo.deleted);
  function updateInfo() {
    //    console.log(description,speed,repetitionNumber);
    cardObject.width = width;
    cardObject.startP = startP;
    cardObject.endP = endP;
    cardObject.description = description;
    cardObject.speed = speed;
    cardObject.deleted = deleted;
    cardObject.repetitionNumber = repetitionNumber;
    cardObject.iDiv = iDiv;
    cardObject.id = iDiv.id;
    return cardObject;
  }

  function initListener() {
    textSegment.addEventListener('long-press', function (e) {
      createBtnDelete(e);
    });
    divSegment.addEventListener('long-press', function (e) {
      createBtnDelete(e);
    });
    selectSpeed.addEventListener("blur", function (e) {
      var speedRate = selectSpeed.options[selectSpeed.selectedIndex].value;
      speed = speedRate;
      cardFunctionalCore.execute(new CardSpeedCommand(cardObject, speedRate));
    });
    selectNbRepet.addEventListener("blur", function (e) {
      repetitionNumber = selectNbRepet.options[selectNbRepet.selectedIndex].value;
      console.log("nbrepet in card :" + repetitionNumber);
      cardFunctionalCore.execute(new CardNbRepetCommand(cardObject, repetitionNumber));
    });
    divSegment.addEventListener("mousedown", function (e) {
      repetitionNumber = selectNbRepet.options[selectNbRepet.selectedIndex].value;
      var speedRate = selectSpeed.options[selectSpeed.selectedIndex].value;
      speed = speedRate;
      segmentFeedback.startPostion = iDiv.style.left;
      segmentFeedback.width = width;
      description = textSegment.value;
      feedbackOnSliderVideo(true);
      videoFunctionalCoreManager.execute(new RepetPartOfVideoCommand(startDuration, endDuration, repetitionNumber, speedRate));
    }, false);
    //TODO widget color picker
    arrowDown.addEventListener("change", watchColorPicker, false);
  }
  function initGUI() {
    textSegment = document.createElement('input');
    textSegment.className = 'textSegment';
    //UI button speed and slow
    imgRepet = document.createElement("img");
    imgRepet.className = 'imgRepet';
    imgSlow = document.createElement("img");

    imgSlow.className = 'imgSlow';
    selectSpeed = document.createElement("select");
    selectSpeed.className = 'selectSpeed';
    selectNbRepet = document.createElement("select");

    selectNbRepet.className = 'selectNbRepet';
    divInfoCard = document.createElement('div');

    divInfoCard.className = "infoCard";

    /*textSegment.addEventListener("focus", function () {
      cardFunctionalCore.execute(new ModifyCardDescriptionCommand(cardObject,textSegment.value));
    });*/
    textSegment.addEventListener("blur", function () {
      description = textSegment.value;
      cardFunctionalCore.execute(new ModifyCardDescriptionCommand(cardObject, textSegment.value));
    });

    for (var i = 0; i < 20; i += 1) {
      selectSpeed.add(new Option(i / 10 + ""));
    }
    selectSpeed.selectedIndex = 10;
    for (var _i = 0; _i < 20; _i++) {
      selectNbRepet.options.add(new Option(_i + ""));
    }

    selectNbRepet.selectedIndex = 1;

    //Div contenant les info du dessus (taille de div invariable)
    divInfoCard.appendChild(imgSlow);
    divInfoCard.appendChild(selectSpeed);
    divInfoCard.appendChild(imgRepet);
    divInfoCard.appendChild(selectNbRepet);
    divInfoCard.appendChild(textSegment);
    //divInfoCard.appendChild(arrowDown);
    iDiv.appendChild(divSegment);
    iDiv.appendChild(divInfoCard);

    //If the card have been deleted, the color is red, otherwise blue.
    if (cardInfo) {
      if (cardInfo.deleted) {
        divSegment.style.backgroundColor = "red";
      } else {
        divSegment.style.backgroundColor = "#213F8D";
      }
      textSegment.value = cardInfo.description;
      selectNbRepet.selectedIndex = cardInfo.repetitionNumber;
      selectSpeed.selectedIndex = cardInfo.speed * 10;
    }
  }

  function initStyle() {
    textSegment.style.left = divSegment.style.width;
    imgSlow.src = "/media/workshop2/card/slow.png";
    imgRepet.src = "/media/workshop2/card/repet.png";
  }

  function createBtnDelete(e) {
    e.preventDefault();
    //delete apparait
    var buttonDelete = document.createElement('button');
    buttonDelete.id = 'idBtnDelete';
    buttonDelete.style.position = "absolute";
    buttonDelete.type = "button";
    buttonDelete.innerHTML = "Delete";
    buttonDelete.style.width = "100px";
    divInfoCard.appendChild(buttonDelete);
    buttonDelete.addEventListener('mouseup', function (e) {
      //TODO
      cardManager.execute(new DeleteCardCommand(cardObject));
      //deleteCard(cardObject);
    });

    buttonDelete.addEventListener('touchend', function (e) {
      cardManager.execute(new DeleteCardCommand(cardObject));
      //deleteCard();
    });
  }

  cardObject = {
    width: width,
    startP: startP,
    endP: endP,
    description: this.description,
    speed: this.speed,
    repetitionNumber: this.repetitionNumber,
    iDiv: iDiv,
    id: iDiv.id,
    updateInfo: updateInfo
  };

  return cardObject;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNhcmQuanMiXSwibmFtZXMiOlsiY2FyZEZ1bmN0aW9uYWxDb3JlIiwiQ2FyZEZ1bmN0aW9uYWxDb3JlIiwiQ2FyZCIsInN0YXJ0RHVyYXRpb25QYXJhbSIsImVuZER1cmF0aW9uUGFyYW0iLCJzdGFydFBvc2l0aW9uUGFyYW0iLCJlbmRQb3NpdGlvblBhcmFtIiwiY2FyZEluZm8iLCJkZXNjcmlwdGlvbiIsIndpZHRoIiwiaGVpZ2h0IiwiZGVsZXRlZCIsImlEaXYiLCJzdGFydFAiLCJlbmRQIiwic3BlZWQiLCJyZXBldGl0aW9uTnVtYmVyIiwiZGl2SW5mb0NhcmQiLCJzZWxlY3ROYlJlcGV0Iiwic2VsZWN0U3BlZWQiLCJpbWdTbG93IiwidGV4dFNlZ21lbnQiLCJpbWdSZXBldCIsImRpdlNlZ21lbnQiLCJzdGFydER1cmF0aW9uIiwiZW5kRHVyYXRpb24iLCJsZWZ0IiwiYnV0dG9uRGVsZXRlIiwiY2FyZE9iamVjdCIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImlkIiwiY3JlYXRlVW5pcXVlSWQiLCJjbGFzc05hbWUiLCJzdHlsZSIsImFycm93RG93biIsInR5cGUiLCJ2YWx1ZSIsImpzY29sb3IiLCJpbnN0YWxsQnlDbGFzc05hbWUiLCJwYXJzZUludCIsImluaXRHVUkiLCJpbml0U3R5bGUiLCJpbml0TGlzdGVuZXIiLCJwbGF5Q2FyZCIsIndhdGNoQ29sb3JQaWNrZXIiLCJldmVudCIsImJhY2tncm91bmRDb2xvciIsInRhcmdldCIsImNvbnNvbGUiLCJsb2ciLCJ1cGRhdGVJbmZvIiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJjcmVhdGVCdG5EZWxldGUiLCJzcGVlZFJhdGUiLCJvcHRpb25zIiwic2VsZWN0ZWRJbmRleCIsImV4ZWN1dGUiLCJDYXJkU3BlZWRDb21tYW5kIiwiQ2FyZE5iUmVwZXRDb21tYW5kIiwic2VnbWVudEZlZWRiYWNrIiwic3RhcnRQb3N0aW9uIiwiZmVlZGJhY2tPblNsaWRlclZpZGVvIiwidmlkZW9GdW5jdGlvbmFsQ29yZU1hbmFnZXIiLCJSZXBldFBhcnRPZlZpZGVvQ29tbWFuZCIsIk1vZGlmeUNhcmREZXNjcmlwdGlvbkNvbW1hbmQiLCJpIiwiYWRkIiwiT3B0aW9uIiwiYXBwZW5kQ2hpbGQiLCJzcmMiLCJwcmV2ZW50RGVmYXVsdCIsInBvc2l0aW9uIiwiaW5uZXJIVE1MIiwiY2FyZE1hbmFnZXIiLCJEZWxldGVDYXJkQ29tbWFuZCJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxJQUFJQSxxQkFBcUIsSUFBSUMsa0JBQUosRUFBekI7O0FBRUEsU0FBU0MsSUFBVCxDQUFlQyxrQkFBZixFQUFrQ0MsZ0JBQWxDLEVBQW1EQyxrQkFBbkQsRUFBc0VDLGdCQUF0RSxFQUF3RkMsUUFBeEYsRUFBa0c7QUFDaEcsTUFBSUMsY0FBYyxFQUFsQjs7QUFFQTtBQUNBLE1BQUlDLFFBQVEsSUFBWjtBQUNBLE1BQUlDLFNBQVMsSUFBYjtBQUNBLE1BQUlDLFVBQVUsS0FBZDtBQUNBLE1BQUlDLE9BQU8sSUFBWDtBQUNBLE1BQUlDLFNBQVNSLGtCQUFiO0FBQ0EsTUFBSVMsT0FBT1IsZ0JBQVg7QUFDRjtBQUNFLE1BQUlTLFFBQVEsQ0FBWjtBQUNBLE1BQUlDLG1CQUFtQixDQUF2QjtBQUNGO0FBQ0UsTUFBSUMsY0FBYyxJQUFsQjtBQUNBO0FBQ0EsTUFBSUMsZ0JBQWdCLElBQXBCO0FBQ0EsTUFBSUMsY0FBYyxJQUFsQjs7QUFFQSxNQUFJQyxVQUFVLElBQWQ7O0FBRUEsTUFBSUMsY0FBYyxJQUFsQjtBQUNBLE1BQUlDLFdBQVcsSUFBZjtBQUNBLE1BQUlDLGFBQWEsSUFBakI7QUFDQSxNQUFJQyxnQkFBZ0JyQixrQkFBcEI7QUFDQSxNQUFJc0IsY0FBY3JCLGdCQUFsQjtBQUNBLE1BQUlzQixhQUFKOztBQUVBLE1BQUlDLGVBQWUsSUFBbkI7QUFDQSxNQUFJQyxVQUFKOztBQUVBO0FBQ0FoQixTQUFPaUIsU0FBU0MsYUFBVCxDQUF1QixLQUF2QixDQUFQO0FBQ0FsQixPQUFLbUIsRUFBTCxHQUFVLFdBQVdDLGdCQUFyQjtBQUNB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a0JBQVlqQixPQUFaLENBQW9CLElBQUlrQixpQkFBSixDQUFzQmhELFVBQXRCLENBQXBCO0FBQ0E7QUFDRCxLQUhEO0FBSUQ7O0FBRURBLGVBQWE7QUFDWG5CLFdBQVFBLEtBREc7QUFFWEksWUFBU0EsTUFGRTtBQUdYQyxVQUFPQSxJQUhJO0FBSVhOLGlCQUFjLEtBQUtBLFdBSlI7QUFLWE8sV0FBUyxLQUFLQSxLQUxIO0FBTVhDLHNCQUFvQixLQUFLQSxnQkFOZDtBQU9YSixVQUFLQSxJQVBNO0FBUVhtQixRQUFHbkIsS0FBS21CLEVBUkc7QUFTWG9CLGdCQUFhQTtBQVRGLEdBQWI7O0FBYUEsU0FBT3ZCLFVBQVA7QUFDRCIsImZpbGUiOiJjYXJkLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGNhcmRGdW5jdGlvbmFsQ29yZSA9IG5ldyBDYXJkRnVuY3Rpb25hbENvcmUoKTtcblxuZnVuY3Rpb24gQ2FyZCAoc3RhcnREdXJhdGlvblBhcmFtLGVuZER1cmF0aW9uUGFyYW0sc3RhcnRQb3NpdGlvblBhcmFtLGVuZFBvc2l0aW9uUGFyYW0sIGNhcmRJbmZvKSB7XG4gIHZhciBkZXNjcmlwdGlvbiA9ICcnO1xuICBcbiAgLy9Qcm9wcmnDqXTDqSBkZSBzdHlsZVxuICBsZXQgd2lkdGggPSAnNiUnO1xuICBsZXQgaGVpZ2h0ID0gJzYlJztcbiAgdmFyIGRlbGV0ZWQgPSBmYWxzZTtcbiAgdmFyIGlEaXYgPSBudWxsO1xuICB2YXIgc3RhcnRQID0gc3RhcnRQb3NpdGlvblBhcmFtO1xuICB2YXIgZW5kUCA9IGVuZFBvc2l0aW9uUGFyYW07XG4vL1ZhbGV1ciBwb3VyIGpvdWVyIGxhIGNhcnRlXG4gIHZhciBzcGVlZCA9IDE7XG4gIHZhciByZXBldGl0aW9uTnVtYmVyID0gMTtcbi8vZGl2IHVzZWRcbiAgbGV0IGRpdkluZm9DYXJkID0gbnVsbDtcbiAgLy9sZXQgc2VsZWN0U3BlZWQ9bnVsbDtcbiAgbGV0IHNlbGVjdE5iUmVwZXQgPSBudWxsO1xuICBsZXQgc2VsZWN0U3BlZWQgPSBudWxsO1xuICBcbiAgbGV0IGltZ1Nsb3cgPSBudWxsO1xuICBcbiAgdmFyIHRleHRTZWdtZW50ID0gbnVsbDtcbiAgbGV0IGltZ1JlcGV0ID0gbnVsbDtcbiAgbGV0IGRpdlNlZ21lbnQgPSBudWxsO1xuICBsZXQgc3RhcnREdXJhdGlvbiA9IHN0YXJ0RHVyYXRpb25QYXJhbTtcbiAgbGV0IGVuZER1cmF0aW9uID0gZW5kRHVyYXRpb25QYXJhbTtcbiAgbGV0IGxlZnQgO1xuICBcbiAgdmFyIGJ1dHRvbkRlbGV0ZSA9IG51bGw7XG4gIHZhciBjYXJkT2JqZWN0O1xuICBcbiAgLy9jZXR0ZSBkaXYgZXN0IGxhIHByaW5jaXBhbGUsIGNlbGxlIHF1aSBjb250aWVudCBmcmFnbWVudCArIGJhcmRGcmFnbWVudFxuICBpRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gIGlEaXYuaWQgPSAnaWRDYXJkJyArIGNyZWF0ZVVuaXF1ZUlkKCk7XG4gIGlEaXYuY2xhc3NOYW1lID0gJ3NlZ21lbnRXcmFwcGVyJztcbiAgaURpdi5zdHlsZS5sZWZ0ID0gc3RhcnRQb3NpdGlvblBhcmFtICsgXCJweFwiO1xuICBcbiAgXG4gIC8vQ29sb3IgcGlja2VyXG4gIHZhciBhcnJvd0Rvd24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xuICBhcnJvd0Rvd24udHlwZSA9ICdqc2NvbG9yJztcbiAgYXJyb3dEb3duLmNsYXNzTmFtZSA9ICdqc2NvbG9yJztcbiAgYXJyb3dEb3duLnZhbHVlID0gJyM4REZGRkYnO1xuICBqc2NvbG9yLmluc3RhbGxCeUNsYXNzTmFtZShcImpzY29sb3JcIik7XG4gIFxuICBcbiAgXG4gIC8qIGFycm93RG93bi5ib3JkZXIgPSAnbm9uZSc7XG4gICBhcnJvd0Rvd24ub3V0bGluZSA9ICdub25lJztcbiAgIGFycm93RG93bi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAnYmxhY2snO1xuICAgYXJyb3dEb3duLnN0eWxlLndlYmtpdEFwcGVhcmFuY2UgPSAnbGlzdGl0ZW0nO1xuICAgYXJyb3dEb3duLnZhbHVlID0gXCIjNDE1NjhkXCI7Ki9cbiAgXG4gICAgIC8vYXJyb3dEb3duLnZhbHVlID0gXCJGRjk5MDBcIjtcbiAgLy9hcnJvd0Rvd24ubW9kZSA9ICdIUyc7XG4gIC8vYXJyb3dEb3duLnBvc2l0aW9uID0gJ3JpZ2h0JyA7XG4gLyogYXJyb3dEb3duLnZhbHVlID1cIiMxMDJiOWZcIjtcbiAgYXJyb3dEb3duLnN0eWxlLm91dGxpbmU9XCJub25lXCI7Ki9cbiAgXG4gIC8vRGl2IGR1IHNlZ21lbnQgYmxldVxuICBkaXZTZWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gIGRpdlNlZ21lbnQuY2xhc3NOYW1lID0gJ3NlZ21lbnQnO1xuICBcbiAgLy90YWlsbGUgZGUgbGEgY2FydGUgaW5pdGlhbGVcbiAgd2lkdGggPSBpRGl2LnN0eWxlLndpZHRoID0gcGFyc2VJbnQoZW5kUG9zaXRpb25QYXJhbSwgMTApIC0gcGFyc2VJbnQoc3RhcnRQb3NpdGlvblBhcmFtLCAxMCkgKyBcInB4XCI7XG4gIGRpdlNlZ21lbnQuc3R5bGUud2lkdGggPSBwYXJzZUludChlbmRQb3NpdGlvblBhcmFtLCAxMCkgLSBwYXJzZUludChzdGFydFBvc2l0aW9uUGFyYW0sIDEwKSArIFwicHhcIjtcbiAgXG4gIGluaXRHVUkoKTtcbiAgaW5pdFN0eWxlKCk7XG4gIGluaXRMaXN0ZW5lcigpO1xuICBwbGF5Q2FyZChpRGl2LCBzdGFydER1cmF0aW9uUGFyYW0pO1xuICBcbiAgXG4gIGZ1bmN0aW9uIHdhdGNoQ29sb3JQaWNrZXIoZXZlbnQpIHtcbiAgICBkaXZTZWdtZW50LnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGV2ZW50LnRhcmdldC52YWx1ZTtcbiAgICBjb25zb2xlLmxvZyhcImNvbG9yXCIpO1xuICB9XG4gIC8vY29uc29sZS5sb2coY2FyZEluZm8uZGVsZXRlZCk7XG4gIGZ1bmN0aW9uIHVwZGF0ZUluZm8oKXtcbi8vICAgIGNvbnNvbGUubG9nKGRlc2NyaXB0aW9uLHNwZWVkLHJlcGV0aXRpb25OdW1iZXIpO1xuICAgIGNhcmRPYmplY3Qud2lkdGggPSB3aWR0aDtcbiAgICBjYXJkT2JqZWN0LnN0YXJ0UCA9IHN0YXJ0UDtcbiAgICBjYXJkT2JqZWN0LmVuZFAgPSBlbmRQO1xuICAgIGNhcmRPYmplY3QuZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjtcbiAgICBjYXJkT2JqZWN0LnNwZWVkID0gc3BlZWQ7XG4gICAgY2FyZE9iamVjdC5kZWxldGVkID0gZGVsZXRlZDtcbiAgICBjYXJkT2JqZWN0LnJlcGV0aXRpb25OdW1iZXIgPSByZXBldGl0aW9uTnVtYmVyO1xuICAgIGNhcmRPYmplY3QuaURpdiA9IGlEaXY7XG4gICAgY2FyZE9iamVjdC5pZCA9IGlEaXYuaWQ7XG4gICAgcmV0dXJuIGNhcmRPYmplY3Q7XG4gIH1cbiAgXG4gIFxuICBmdW5jdGlvbiBpbml0TGlzdGVuZXIoKSB7XG4gICAgdGV4dFNlZ21lbnQuYWRkRXZlbnRMaXN0ZW5lcignbG9uZy1wcmVzcycsIGZ1bmN0aW9uKGUpe1xuICAgICAgY3JlYXRlQnRuRGVsZXRlKGUpO1xuICAgIH0pO1xuICAgIGRpdlNlZ21lbnQuYWRkRXZlbnRMaXN0ZW5lcignbG9uZy1wcmVzcycsIGZ1bmN0aW9uKGUpe1xuICAgICAgY3JlYXRlQnRuRGVsZXRlKGUpO1xuICAgIH0pO1xuICAgIHNlbGVjdFNwZWVkLmFkZEV2ZW50TGlzdGVuZXIoXCJibHVyXCIsIGZ1bmN0aW9uKGUpe1xuICAgICAgbGV0IHNwZWVkUmF0ZSA9IHNlbGVjdFNwZWVkLm9wdGlvbnNbc2VsZWN0U3BlZWQuc2VsZWN0ZWRJbmRleF0udmFsdWU7XG4gICAgICBzcGVlZCA9IHNwZWVkUmF0ZTtcbiAgICAgIGNhcmRGdW5jdGlvbmFsQ29yZS5leGVjdXRlKG5ldyBDYXJkU3BlZWRDb21tYW5kKGNhcmRPYmplY3Qsc3BlZWRSYXRlKSk7XG4gICAgfSk7XG4gICAgc2VsZWN0TmJSZXBldC5hZGRFdmVudExpc3RlbmVyKFwiYmx1clwiLCBmdW5jdGlvbihlKXtcbiAgICAgIHJlcGV0aXRpb25OdW1iZXIgPSBzZWxlY3ROYlJlcGV0Lm9wdGlvbnNbc2VsZWN0TmJSZXBldC5zZWxlY3RlZEluZGV4XS52YWx1ZTtcbiAgICAgIGNvbnNvbGUubG9nKFwibmJyZXBldCBpbiBjYXJkIDpcIiArICByZXBldGl0aW9uTnVtYmVyKTtcbiAgICAgIGNhcmRGdW5jdGlvbmFsQ29yZS5leGVjdXRlKG5ldyBDYXJkTmJSZXBldENvbW1hbmQoY2FyZE9iamVjdCwgcmVwZXRpdGlvbk51bWJlcikpO1xuICAgIH0pO1xuICAgIGRpdlNlZ21lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCBmdW5jdGlvbiAoZSkge1xuICAgICAgcmVwZXRpdGlvbk51bWJlciA9IHNlbGVjdE5iUmVwZXQub3B0aW9uc1tzZWxlY3ROYlJlcGV0LnNlbGVjdGVkSW5kZXhdLnZhbHVlO1xuICAgICAgbGV0IHNwZWVkUmF0ZSA9IHNlbGVjdFNwZWVkLm9wdGlvbnNbc2VsZWN0U3BlZWQuc2VsZWN0ZWRJbmRleF0udmFsdWU7XG4gICAgICBzcGVlZCA9IHNwZWVkUmF0ZTtcbiAgICAgIHNlZ21lbnRGZWVkYmFjay5zdGFydFBvc3Rpb24gPSBpRGl2LnN0eWxlLmxlZnQgIDtcbiAgICAgIHNlZ21lbnRGZWVkYmFjay53aWR0aCA9IHdpZHRoO1xuICAgICAgZGVzY3JpcHRpb24gPSB0ZXh0U2VnbWVudC52YWx1ZTtcbiAgICAgIGZlZWRiYWNrT25TbGlkZXJWaWRlbyh0cnVlKTtcbiAgICAgIHZpZGVvRnVuY3Rpb25hbENvcmVNYW5hZ2VyLmV4ZWN1dGUobmV3IFJlcGV0UGFydE9mVmlkZW9Db21tYW5kKHN0YXJ0RHVyYXRpb24sIGVuZER1cmF0aW9uLCByZXBldGl0aW9uTnVtYmVyLCBzcGVlZFJhdGUpKTtcbiAgICB9LCBmYWxzZSk7XG4gICAgLy9UT0RPIHdpZGdldCBjb2xvciBwaWNrZXJcbiAgICBhcnJvd0Rvd24uYWRkRXZlbnRMaXN0ZW5lcihcImNoYW5nZVwiLCB3YXRjaENvbG9yUGlja2VyLCBmYWxzZSk7XG4gIH1cbiAgZnVuY3Rpb24gaW5pdEdVSSgpIHtcbiAgICB0ZXh0U2VnbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XG4gICAgdGV4dFNlZ21lbnQuY2xhc3NOYW1lID0gJ3RleHRTZWdtZW50JztcbiAgICAvL1VJIGJ1dHRvbiBzcGVlZCBhbmQgc2xvd1xuICAgIGltZ1JlcGV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImltZ1wiKTtcbiAgICBpbWdSZXBldC5jbGFzc05hbWU9J2ltZ1JlcGV0JztcbiAgICBpbWdTbG93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImltZ1wiKTtcbiAgXG4gICAgaW1nU2xvdy5jbGFzc05hbWU9J2ltZ1Nsb3cnO1xuICAgIHNlbGVjdFNwZWVkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNlbGVjdFwiKTtcbiAgICBzZWxlY3RTcGVlZC5jbGFzc05hbWUgPSdzZWxlY3RTcGVlZCcgO1xuICAgIHNlbGVjdE5iUmVwZXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic2VsZWN0XCIpO1xuICBcbiAgICBzZWxlY3ROYlJlcGV0LmNsYXNzTmFtZSA9J3NlbGVjdE5iUmVwZXQnIDtcbiAgICBkaXZJbmZvQ2FyZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICBcbiAgICBkaXZJbmZvQ2FyZC5jbGFzc05hbWUgPSBcImluZm9DYXJkXCI7XG4gICAgXG4gICAgLyp0ZXh0U2VnbWVudC5hZGRFdmVudExpc3RlbmVyKFwiZm9jdXNcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgY2FyZEZ1bmN0aW9uYWxDb3JlLmV4ZWN1dGUobmV3IE1vZGlmeUNhcmREZXNjcmlwdGlvbkNvbW1hbmQoY2FyZE9iamVjdCx0ZXh0U2VnbWVudC52YWx1ZSkpO1xuICAgIH0pOyovXG4gICAgdGV4dFNlZ21lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImJsdXJcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgZGVzY3JpcHRpb24gPSB0ZXh0U2VnbWVudC52YWx1ZTtcbiAgICAgIGNhcmRGdW5jdGlvbmFsQ29yZS5leGVjdXRlKG5ldyBNb2RpZnlDYXJkRGVzY3JpcHRpb25Db21tYW5kKGNhcmRPYmplY3QsdGV4dFNlZ21lbnQudmFsdWUpKTtcbiAgICB9KTtcbiAgICBcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDIwOyBpICs9IDEpIHtcbiAgICAgIHNlbGVjdFNwZWVkLmFkZChuZXcgT3B0aW9uKGkgLyAxMCArIFwiXCIpKTtcbiAgICB9XG4gICAgc2VsZWN0U3BlZWQuc2VsZWN0ZWRJbmRleCA9IDEwO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMjA7IGkrKykge1xuICAgICAgc2VsZWN0TmJSZXBldC5vcHRpb25zLmFkZChuZXcgT3B0aW9uKGkgKyBcIlwiKSk7XG4gICAgfVxuICBcbiAgICBzZWxlY3ROYlJlcGV0LnNlbGVjdGVkSW5kZXggPSAxO1xuICBcbiAgICAvL0RpdiBjb250ZW5hbnQgbGVzIGluZm8gZHUgZGVzc3VzICh0YWlsbGUgZGUgZGl2IGludmFyaWFibGUpXG4gICAgZGl2SW5mb0NhcmQuYXBwZW5kQ2hpbGQoaW1nU2xvdyk7XG4gICAgZGl2SW5mb0NhcmQuYXBwZW5kQ2hpbGQoc2VsZWN0U3BlZWQpO1xuICAgIGRpdkluZm9DYXJkLmFwcGVuZENoaWxkKGltZ1JlcGV0KTtcbiAgICBkaXZJbmZvQ2FyZC5hcHBlbmRDaGlsZChzZWxlY3ROYlJlcGV0KTtcbiAgICBkaXZJbmZvQ2FyZC5hcHBlbmRDaGlsZCh0ZXh0U2VnbWVudCk7XG4gICAgLy9kaXZJbmZvQ2FyZC5hcHBlbmRDaGlsZChhcnJvd0Rvd24pO1xuICAgIGlEaXYuYXBwZW5kQ2hpbGQoZGl2U2VnbWVudCk7XG4gICAgaURpdi5hcHBlbmRDaGlsZChkaXZJbmZvQ2FyZCk7XG4gIFxuICBcbiAgICAvL0lmIHRoZSBjYXJkIGhhdmUgYmVlbiBkZWxldGVkLCB0aGUgY29sb3IgaXMgcmVkLCBvdGhlcndpc2UgYmx1ZS5cbiAgICBpZiAoY2FyZEluZm8pIHtcbiAgICAgIGlmKGNhcmRJbmZvLmRlbGV0ZWQpe1xuICAgICAgICBkaXZTZWdtZW50LnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwicmVkXCI7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBkaXZTZWdtZW50LnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwiIzIxM0Y4RFwiO1xuICAgICAgfVxuICAgICAgdGV4dFNlZ21lbnQudmFsdWUgPSBjYXJkSW5mby5kZXNjcmlwdGlvbjtcbiAgICAgIHNlbGVjdE5iUmVwZXQuc2VsZWN0ZWRJbmRleCA9IGNhcmRJbmZvLnJlcGV0aXRpb25OdW1iZXI7XG4gICAgICBzZWxlY3RTcGVlZC5zZWxlY3RlZEluZGV4ID0gY2FyZEluZm8uc3BlZWQqMTA7XG4gICAgfVxuICAgIFxuICB9XG4gIFxuICBcbiAgXG4gIGZ1bmN0aW9uIGluaXRTdHlsZSgpIHtcbiAgICB0ZXh0U2VnbWVudC5zdHlsZS5sZWZ0ID0gZGl2U2VnbWVudC5zdHlsZS53aWR0aDtcbiAgICBpbWdTbG93LnNyYyA9IFwiL21lZGlhL3dvcmtzaG9wMi9jYXJkL3Nsb3cucG5nXCI7XG4gICAgaW1nUmVwZXQuc3JjID0gXCIvbWVkaWEvd29ya3Nob3AyL2NhcmQvcmVwZXQucG5nXCI7XG4gIH1cbiAgXG4gIFxuICBcbiAgZnVuY3Rpb24gY3JlYXRlQnRuRGVsZXRlKGUpe1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAvL2RlbGV0ZSBhcHBhcmFpdFxuICAgIHZhciBidXR0b25EZWxldGUgPSAgZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgYnV0dG9uRGVsZXRlLmlkID0gJ2lkQnRuRGVsZXRlJztcbiAgICBidXR0b25EZWxldGUuc3R5bGUucG9zaXRpb24gPSBcImFic29sdXRlXCI7XG4gICAgYnV0dG9uRGVsZXRlLnR5cGUgPSBcImJ1dHRvblwiO1xuICAgIGJ1dHRvbkRlbGV0ZS5pbm5lckhUTUwgPSBcIkRlbGV0ZVwiO1xuICAgIGJ1dHRvbkRlbGV0ZS5zdHlsZS53aWR0aCA9IFwiMTAwcHhcIjtcbiAgICBkaXZJbmZvQ2FyZC5hcHBlbmRDaGlsZChidXR0b25EZWxldGUpO1xuICAgIGJ1dHRvbkRlbGV0ZS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJyxmdW5jdGlvbihlKXtcbiAgICAgIC8vVE9ET1xuICAgICAgY2FyZE1hbmFnZXIuZXhlY3V0ZShuZXcgRGVsZXRlQ2FyZENvbW1hbmQoY2FyZE9iamVjdCkpO1xuICAgICAgLy9kZWxldGVDYXJkKGNhcmRPYmplY3QpO1xuICAgIH0pO1xuICAgIFxuICAgIGJ1dHRvbkRlbGV0ZS5hZGRFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsZnVuY3Rpb24oZSl7XG4gICAgICBjYXJkTWFuYWdlci5leGVjdXRlKG5ldyBEZWxldGVDYXJkQ29tbWFuZChjYXJkT2JqZWN0KSk7XG4gICAgICAvL2RlbGV0ZUNhcmQoKTtcbiAgICB9KTtcbiAgfVxuICBcbiAgY2FyZE9iamVjdCA9IHtcbiAgICB3aWR0aDogIHdpZHRoLFxuICAgIHN0YXJ0UCA6IHN0YXJ0UCxcbiAgICBlbmRQIDogZW5kUCxcbiAgICBkZXNjcmlwdGlvbiA6IHRoaXMuZGVzY3JpcHRpb24sXG4gICAgc3BlZWQgOiAgdGhpcy5zcGVlZCxcbiAgICByZXBldGl0aW9uTnVtYmVyIDogIHRoaXMucmVwZXRpdGlvbk51bWJlcixcbiAgICBpRGl2OmlEaXYsXG4gICAgaWQ6aURpdi5pZCxcbiAgICB1cGRhdGVJbmZvIDogdXBkYXRlSW5mb1xuICB9O1xuICBcbiAgXG4gIHJldHVybiBjYXJkT2JqZWN0O1xufVxuXG5cblxuIl19